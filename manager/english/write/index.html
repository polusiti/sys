<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¦ç´„å•é¡Œç®¡ç†ã‚·ã‚¹ãƒ†ãƒ  - Questa Manager</title>
    
    <!-- PWA Meta Tags -->
    <link rel="manifest" href="../../manifest.json">
    <meta name="theme-color" content="#3b82f6">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="è¦ç´„ç®¡ç†">
    <link rel="apple-touch-icon" href="https://pub-d59d6e46c3154423956f648f8df909ae.r2.dev/61203.jpg">
    <meta name="msapplication-TileColor" content="#3b82f6">
    <meta name="msapplication-TileImage" content="https://pub-d59d6e46c3154423956f648f8df909ae.r2.dev/61203.jpg">
    
    <!-- SEO Meta Tags -->
    <meta name="description" content="è‹±èªè¦ç´„å•é¡Œã®ä½œæˆãƒ»ç·¨é›†ãƒ»ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ã€‚ã‚ªãƒ•ãƒ©ã‚¤ãƒ³å¯¾å¿œPWAã‚¢ãƒ—ãƒªã€‚">
    <meta name="keywords" content="è‹±èª,è¦ç´„,å•é¡Œä½œæˆ,ç®¡ç†,PWA,ã‚ªãƒ•ãƒ©ã‚¤ãƒ³">
    <meta name="author" content="Questa Manager">
    
    <!-- Open Graph -->
    <meta property="og:title" content="è¦ç´„å•é¡Œç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ">
    <meta property="og:description" content="è‹±èªè¦ç´„å•é¡Œã®ä½œæˆãƒ»ç·¨é›†ãƒ»ç®¡ç†">
    <meta property="og:type" content="website">
    <meta property="og:image" content="https://pub-d59d6e46c3154423956f648f8df909ae.r2.dev/61203.jpg">
    <style>
        :root {
            --primary-color: #6366f1;
            --secondary-color: #4f46e5;
            --accent-color: #818cf8;
            --bg-color: #f8fafc;
            --text-color: #1e293b;
            --border-color: #e2e8f0;
            --hover-bg: #f1f5f9;
            
            /* ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚«ãƒ©ãƒ¼ */
            --voca-color: #10b981;
            --grammar-color: #f59e0b;
            --reading-color: #8b5cf6;
            --listening-color: #ef4444;
            --summary-color: #3b82f6;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            line-height: 1.6;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 40px 20px;
            border-radius: 16px;
            margin-bottom: 30px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(99, 102, 241, 0.3);
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 15px;
            font-weight: 700;
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .nav-tabs {
            display: flex;
            background: white;
            border-radius: 12px;
            padding: 8px;
            margin-bottom: 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            overflow-x: auto;
        }

        .nav-tab {
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
            white-space: nowrap;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .nav-tab:hover {
            background: var(--hover-bg);
        }

        .nav-tab.active {
            background: var(--primary-color);
            color: white;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .modules-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }

        .module-card {
            background: white;
            border-radius: 16px;
            padding: 30px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            transition: all 0.3s ease;
            text-decoration: none;
            color: inherit;
            display: block;
            position: relative;
            overflow: hidden;
        }

        .module-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--module-color), var(--accent-color));
        }

        .module-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 30px rgba(0,0,0,0.15);
        }

        .module-icon {
            font-size: 3rem;
            margin-bottom: 20px;
        }

        .module-title {
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 15px;
        }

        .module-description {
            color: #64748b;
            line-height: 1.6;
            margin-bottom: 20px;
        }

        .module-stats {
            display: flex;
            gap: 20px;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid var(--border-color);
        }

        .module-stat {
            text-align: center;
        }

        .stat-number {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--module-color);
        }

        .stat-label {
            font-size: 0.875rem;
            color: #64748b;
        }

        .module-features {
            list-style: none;
            margin-bottom: 20px;
        }

        .module-features li {
            padding: 5px 0;
            color: #64748b;
            font-size: 0.9rem;
        }

        .module-features li:before {
            content: "âœ“ ";
            color: var(--module-color);
            font-weight: bold;
        }

        .module-card.voca { --module-color: var(--voca-color); }
        .module-card.grammar { --module-color: var(--grammar-color); }
        .module-card.reading { --module-color: var(--reading-color); }
        .module-card.listening { --module-color: var(--listening-color); }
        .module-card.summary { --module-color: var(--summary-color); }

        .overview-section {
            background: white;
            border-radius: 16px;
            padding: 40px;
            margin-bottom: 30px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
        }

        .overview-title {
            font-size: 2rem;
            color: var(--primary-color);
            margin-bottom: 30px;
            text-align: center;
        }

        .overview-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 30px;
        }

        .overview-card {
            text-align: center;
            padding: 30px;
            background: var(--bg-color);
            border-radius: 12px;
            transition: all 0.3s ease;
        }

        .overview-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.1);
        }

        .overview-icon {
            font-size: 3rem;
            margin-bottom: 20px;
        }

        .overview-number {
            font-size: 2.5rem;
            font-weight: bold;
            color: var(--primary-color);
            margin-bottom: 10px;
        }

        .overview-label {
            color: #64748b;
            font-size: 1.1rem;
        }

        .tools-section {
            background: white;
            border-radius: 16px;
            padding: 40px;
            margin-bottom: 30px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
        }

        .tools-title {
            font-size: 2rem;
            color: var(--primary-color);
            margin-bottom: 30px;
            text-align: center;
        }

        .tools-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }

        .tool-card {
            background: var(--bg-color);
            padding: 25px;
            border-radius: 12px;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .tool-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.1);
        }

        .tool-icon {
            font-size: 2.5rem;
            margin-bottom: 15px;
        }

        .tool-name {
            font-weight: bold;
            margin-bottom: 10px;
            color: var(--primary-color);
        }

        .tool-description {
            font-size: 0.9rem;
            color: #64748b;
        }

        .recent-section {
            background: white;
            border-radius: 16px;
            padding: 40px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
        }

        .recent-title {
            font-size: 2rem;
            color: var(--primary-color);
            margin-bottom: 30px;
            text-align: center;
        }

        .recent-questions {
            display: grid;
            gap: 20px;
        }

        .recent-question {
            background: var(--bg-color);
            padding: 20px;
            border-radius: 12px;
            border-left: 4px solid var(--primary-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .question-info h4 {
            color: var(--primary-color);
            margin-bottom: 5px;
        }

        .question-meta {
            font-size: 0.875rem;
            color: #64748b;
        }

        .question-type {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 500;
            color: white;
        }

        .type-voca { background: var(--voca-color); }
        .type-grammar { background: var(--grammar-color); }
        .type-reading { background: var(--reading-color); }
        .type-listening { background: var(--listening-color); }
        .type-summary { background: var(--summary-color); }

        .footer {
            text-align: center;
            margin-top: 60px;
            color: #64748b;
            padding: 20px;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }
            
            .nav-tabs {
                flex-wrap: wrap;
            }
            
            .modules-grid {
                grid-template-columns: 1fr;
            }
            
            .overview-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .tools-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>çµ±åˆè‹±èªå•é¡Œç®¡ç†ã‚·ã‚¹ãƒ†ãƒ </h1>
            <p>ã‚ã‚‰ã‚†ã‚‹ã‚¿ã‚¤ãƒ—ã®è‹±èªå•é¡Œã‚’ä½œæˆãƒ»ç®¡ç†ã™ã‚‹ç·åˆãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ </p>
        </div>

        <div class="nav-tabs">
            <div class="nav-tab active" onclick="showTab('overview')">
                ğŸ“Š æ¦‚è¦
            </div>
            <div class="nav-tab" onclick="showTab('modules')">
                ğŸ“š ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«
            </div>
            <div class="nav-tab" onclick="showTab('tools')">
                ğŸ› ï¸ ãƒ„ãƒ¼ãƒ«
            </div>
            <div class="nav-tab" onclick="showTab('recent')">
                ğŸ“ æœ€è¿‘ã®å•é¡Œ
            </div>
        </div>

        <div id="overview" class="tab-content active">
            <div class="overview-section">
                <h2 class="overview-title">ã‚·ã‚¹ãƒ†ãƒ æ¦‚è¦</h2>
                <div class="overview-grid">
                    <div class="overview-card">
                        <div class="overview-icon">ğŸ“</div>
                        <div class="overview-number" id="totalQuestions">0</div>
                        <div class="overview-label">ç·å•é¡Œæ•°</div>
                    </div>
                    <div class="overview-card">
                        <div class="overview-icon">ğŸ¯</div>
                        <div class="overview-number">5</div>
                        <div class="overview-label">å°‚é–€ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«</div>
                    </div>
                    <div class="overview-card">
                        <div class="overview-icon">ğŸ“‹</div>
                        <div class="overview-number">15+</div>
                        <div class="overview-label">å•é¡Œå½¢å¼</div>
                    </div>
                    <div class="overview-card">
                        <div class="overview-icon">ğŸ’¾</div>
                        <div class="overview-number">âœ“</div>
                        <div class="overview-label">ãƒ­ãƒ¼ã‚«ãƒ«ä¿å­˜</div>
                    </div>
                </div>
            </div>
        </div>

        <div id="modules" class="tab-content">
            <div class="modules-grid">
                <a href="../voca/" class="module-card voca">
                    <div class="module-icon">ğŸ“š</div>
                    <h2 class="module-title">èªå½™å•é¡Œ</h2>
                    <p class="module-description">å˜èªã‚„èªå½™ã«é–¢ã™ã‚‹å•é¡Œã‚’ä½œæˆãƒ»ç®¡ç†ã—ã¾ã™</p>
                    <ul class="module-features">
                        <li>æ„å‘³é¸æŠå•é¡Œ</li>
                        <li>ç©ºæ‰€è£œå……å•é¡Œ</li>
                        <li>è¤‡æ•°é¸æŠè‚¢å¯¾å¿œ</li>
                        <li>é›£æ˜“åº¦è¨­å®š</li>
                    </ul>
                    <div class="module-stats">
                        <div class="module-stat">
                            <div class="stat-number" id="vocaCount">0</div>
                            <div class="stat-label">å•é¡Œæ•°</div>
                        </div>
                        <div class="module-stat">
                            <div class="stat-number">2</div>
                            <div class="stat-label">å½¢å¼</div>
                        </div>
                    </div>
                </a>

                <a href="../grammar/" class="module-card grammar">
                    <div class="module-icon">ğŸ“</div>
                    <h2 class="module-title">æ–‡æ³•å•é¡Œ</h2>
                    <p class="module-description">æ–‡æ³•ã‚„æ§‹æ–‡ã«é–¢ã™ã‚‹å•é¡Œã‚’ä½œæˆãƒ»ç®¡ç†ã—ã¾ã™</p>
                    <ul class="module-features">
                        <li>ä¸‹ç·šéƒ¨é¸æŠå•é¡Œ</li>
                        <li>èªé †ä¸¦ã¹æ›¿ãˆå•é¡Œ</li>
                        <li>4æŠãƒ»5æŠå•é¡Œ</li>
                        <li>å¤šå½©ãªå•é¡Œå½¢å¼</li>
                    </ul>
                    <div class="module-stats">
                        <div class="module-stat">
                            <div class="stat-number" id="grammarCount">0</div>
                            <div class="stat-label">å•é¡Œæ•°</div>
                        </div>
                        <div class="module-stat">
                            <div class="stat-number">4</div>
                            <div class="stat-label">å½¢å¼</div>
                        </div>
                    </div>
                </a>

                <a href="../reading/" class="module-card reading">
                    <div class="module-icon">ğŸ“–</div>
                    <h2 class="module-title">èª­è§£å•é¡Œ</h2>
                    <p class="module-description">é•·æ–‡èª­è§£ã‚„æ–‡ç« ç†è§£ã«é–¢ã™ã‚‹å•é¡Œã‚’ä½œæˆãƒ»ç®¡ç†ã—ã¾ã™</p>
                    <ul class="module-features">
                        <li>è¤‡æ•°è¨­å•å¯¾å¿œ</li>
                        <li>å¤šæ§˜ãªèª­è§£å½¢å¼</li>
                        <li>æœ¬æ–‡ã¨å‡ºå…¸ç®¡ç†</li>
                        <li>è¨­å•ç•ªå·è‡ªå‹•ç”Ÿæˆ</li>
                    </ul>
                    <div class="module-stats">
                        <div class="module-stat">
                            <div class="stat-number" id="readingCount">0</div>
                            <div class="stat-label">å•é¡Œæ•°</div>
                        </div>
                        <div class="module-stat">
                            <div class="stat-number">5</div>
                            <div class="stat-label">å½¢å¼</div>
                        </div>
                    </div>
                </a>

                <a href="../listening/" class="module-card listening">
                    <div class="module-icon">ğŸ§</div>
                    <h2 class="module-title">ãƒªã‚¹ãƒ‹ãƒ³ã‚°å•é¡Œ</h2>
                    <p class="module-description">è´è§£åŠ›ã«é–¢ã™ã‚‹å•é¡Œã‚’ä½œæˆãƒ»ç®¡ç†ã—ã¾ã™</p>
                    <ul class="module-features">
                        <li>éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰</li>
                        <li>è¤‡æ•°è¨­å•å¯¾å¿œ</li>
                        <li>ãƒ‰ãƒ©ãƒƒã‚°ï¼†ãƒ‰ãƒ­ãƒƒãƒ—å¯¾å¿œ</li>
                        <li>å•é¡Œã‚»ãƒƒãƒˆç®¡ç†</li>
                    </ul>
                    <div class="module-stats">
                        <div class="module-stat">
                            <div class="stat-number" id="listeningCount">0</div>
                            <div class="stat-label">å•é¡Œæ•°</div>
                        </div>
                        <div class="module-stat">
                            <div class="stat-number">1</div>
                            <div class="stat-label">å½¢å¼</div>
                        </div>
                    </div>
                </a>

                <a href="summary.html" class="module-card summary">
                    <div class="module-icon">ğŸ“„</div>
                    <h2 class="module-title">è¦ç´„å•é¡Œ</h2>
                    <p class="module-description">æ–‡ç« ã®è¦ç´„ã‚¹ã‚­ãƒ«ã‚’è©•ä¾¡ã™ã‚‹å•é¡Œã‚’ä½œæˆãƒ»ç®¡ç†ã—ã¾ã™</p>
                    <ul class="module-features">
                        <li>è¤‡æ•°ã®è¦ç´„é•·ã•å¯¾å¿œ</li>
                        <li>è©•ä¾¡åŸºæº–è¨­å®š</li>
                        <li>æ¨¡ç¯„è§£ç­”ç®¡ç†</li>
                        <li>ã‚¸ãƒ£ãƒ³ãƒ«åˆ†é¡</li>
                    </ul>
                    <div class="module-stats">
                        <div class="module-stat">
                            <div class="stat-number" id="summaryCount">0</div>
                            <div class="stat-label">å•é¡Œæ•°</div>
                        </div>
                        <div class="module-stat">
                            <div class="stat-number">6</div>
                            <div class="stat-label">ã‚¸ãƒ£ãƒ³ãƒ«</div>
                        </div>
                    </div>
                </a>
            </div>
        </div>

        <div id="tools" class="tab-content">
            <div class="tools-section">
                <h2 class="tools-title">ä¾¿åˆ©ãƒ„ãƒ¼ãƒ«</h2>
                <div class="tools-grid">
                    <div class="tool-card" onclick="exportData()">
                        <div class="tool-icon">ğŸ“¤</div>
                        <div class="tool-name">ãƒ‡ãƒ¼ã‚¿ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ</div>
                        <div class="tool-description">ã™ã¹ã¦ã®å•é¡Œãƒ‡ãƒ¼ã‚¿ã‚’JSONå½¢å¼ã§ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ</div>
                    </div>
                    <div class="tool-card" onclick="importData()">
                        <div class="tool-icon">ğŸ“¥</div>
                        <div class="tool-name">ãƒ‡ãƒ¼ã‚¿ã‚¤ãƒ³ãƒãƒ¼ãƒˆ</div>
                        <div class="tool-description">JSONãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰å•é¡Œãƒ‡ãƒ¼ã‚¿ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆ</div>
                    </div>
                    <div class="tool-card" onclick="clearAllData()">
                        <div class="tool-icon">ğŸ—‘ï¸</div>
                        <div class="tool-name">ãƒ‡ãƒ¼ã‚¿æ¶ˆå»</div>
                        <div class="tool-description">ã™ã¹ã¦ã®å•é¡Œãƒ‡ãƒ¼ã‚¿ã‚’æ¶ˆå»</div>
                    </div>
                    <div class="tool-card" onclick="generateReport()">
                        <div class="tool-icon">ğŸ“Š</div>
                        <div class="tool-name">ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ</div>
                        <div class="tool-description">å•é¡Œã®çµ±è¨ˆãƒ¬ãƒãƒ¼ãƒˆã‚’ç”Ÿæˆ</div>
                    </div>
                </div>
            </div>
        </div>

        <div id="recent" class="tab-content">
            <div class="recent-section">
                <h2 class="recent-title">æœ€è¿‘ã®å•é¡Œ</h2>
                <div class="recent-questions" id="recentQuestions">
                    <!-- æœ€è¿‘ã®å•é¡ŒãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™ -->
                </div>
            </div>
        </div>

        <div class="footer">
            <p>&copy; 2024 çµ±åˆè‹±èªå•é¡Œç®¡ç†ã‚·ã‚¹ãƒ†ãƒ . All rights reserved.</p>
        </div>
    </div>

    <script>
        // ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆ
        function showTab(tabName) {
            document.querySelectorAll('.nav-tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById(tabName).classList.add('active');
        }

        // çµ±è¨ˆæƒ…å ±ã®æ›´æ–°
        function updateStats() {
            const modules = [
                { name: 'vocab', id: 'vocaCount' },
                { name: 'grammar', id: 'grammarCount' },
                { name: 'reading', id: 'readingCount' },
                { name: 'listening', id: 'listeningCount' },
                { name: 'summary', id: 'summaryCount' }
            ];
            
            let totalQuestions = 0;
            
            modules.forEach(module => {
                const questions = JSON.parse(localStorage.getItem(module.name + 'Questions') || '[]');
                const count = questions.length;
                document.getElementById(module.id).textContent = count;
                totalQuestions += count;
            });
            
            document.getElementById('totalQuestions').textContent = totalQuestions;
        }

        // æœ€è¿‘ã®å•é¡Œã‚’å–å¾—
        function getRecentQuestions() {
            const modules = ['vocab', 'grammar', 'reading', 'listening', 'summary'];
            let allQuestions = [];
            
            modules.forEach(moduleName => {
                const questions = JSON.parse(localStorage.getItem(moduleName + 'Questions') || '[]');
                questions.forEach(question => {
                    allQuestions.push({
                        ...question,
                        module: moduleName,
                        createdAt: new Date(question.createdAt)
                    });
                });
            });
            
            // ä½œæˆæ—¥ã§ã‚½ãƒ¼ãƒˆã—ã¦æœ€æ–°10ä»¶ã‚’å–å¾—
            allQuestions.sort((a, b) => b.createdAt - a.createdAt);
            return allQuestions.slice(0, 10);
        }

        // æœ€è¿‘ã®å•é¡Œã‚’è¡¨ç¤º
        function displayRecentQuestions() {
            const container = document.getElementById('recentQuestions');
            const recentQuestions = getRecentQuestions();
            
            if (recentQuestions.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: #64748b;">å•é¡ŒãŒã‚ã‚Šã¾ã›ã‚“</p>';
                return;
            }
            
            container.innerHTML = recentQuestions.map(question => {
                const typeNames = {
                    'vocab': 'èªå½™',
                    'grammar': 'æ–‡æ³•',
                    'reading': 'èª­è§£',
                    'listening': 'ãƒªã‚¹ãƒ‹ãƒ³ã‚°',
                    'summary': 'è¦ç´„'
                };
                
                let title = 'ç„¡é¡Œ';
                if (question.module === 'vocab') {
                    title = question.word || question.sentence || 'ç„¡é¡Œ';
                } else if (question.module === 'grammar') {
                    title = question.sentence || question.question || 'ç„¡é¡Œ';
                } else if (question.module === 'reading') {
                    title = question.title || 'ç„¡é¡Œ';
                } else if (question.module === 'listening') {
                    title = question.setTitle || 'ç„¡é¡Œ';
                } else if (question.module === 'summary') {
                    title = question.title || 'ç„¡é¡Œ';
                }
                
                return `
                    <div class="recent-question">
                        <div class="question-info">
                            <h4>${title}</h4>
                            <div class="question-meta">
                                ${typeNames[question.module]} â€¢ 
                                é›£æ˜“åº¦: ${question.difficulty} â€¢ 
                                ${question.createdAt.toLocaleDateString()}
                            </div>
                        </div>
                        <div class="question-type type-${question.module}">
                            ${typeNames[question.module]}
                        </div>
                    </div>
                `;
            }).join('');
        }

        // ãƒ„ãƒ¼ãƒ«æ©Ÿèƒ½
        function exportData() {
            const modules = ['vocab', 'grammar', 'reading', 'listening', 'summary'];
            const exportData = {};
            
            modules.forEach(module => {
                exportData[module] = JSON.parse(localStorage.getItem(module + 'Questions') || '[]');
            });
            
            const dataStr = JSON.stringify(exportData, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(dataBlob);
            
            const link = document.createElement('a');
            link.href = url;
            link.download = `english-questions-${new Date().toISOString().split('T')[0]}.json`;
            link.click();
            
            URL.revokeObjectURL(url);
            showNotification('ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã—ã¾ã—ãŸ');
        }

        function importData() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            input.onchange = function(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        try {
                            const data = JSON.parse(e.target.result);
                            
                            Object.keys(data).forEach(module => {
                                if (Array.isArray(data[module])) {
                                    localStorage.setItem(module + 'Questions', JSON.stringify(data[module]));
                                }
                            });
                            
                            updateStats();
                            displayRecentQuestions();
                            showNotification('ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¾ã—ãŸ');
                        } catch (error) {
                            showNotification('ã‚¤ãƒ³ãƒãƒ¼ãƒˆã«å¤±æ•—ã—ã¾ã—ãŸ', 'error');
                        }
                    };
                    reader.readAsText(file);
                }
            };
            input.click();
        }

        function clearAllData() {
            if (confirm('ã™ã¹ã¦ã®å•é¡Œãƒ‡ãƒ¼ã‚¿ã‚’æ¶ˆå»ã—ã¦ã‚‚ã‚ˆã‚ã—ã„ã§ã™ã‹ï¼Ÿã“ã®æ“ä½œã¯å…ƒã«æˆ»ã›ã¾ã›ã‚“ã€‚')) {
                const modules = ['vocab', 'grammar', 'reading', 'listening', 'summary'];
                modules.forEach(module => {
                    localStorage.removeItem(module + 'Questions');
                });
                
                updateStats();
                displayRecentQuestions();
                showNotification('ã™ã¹ã¦ã®ãƒ‡ãƒ¼ã‚¿ã‚’æ¶ˆå»ã—ã¾ã—ãŸ');
            }
        }

        function generateReport() {
            const modules = ['vocab', 'grammar', 'reading', 'listening', 'summary'];
            let report = 'è‹±èªå•é¡Œç®¡ç†ã‚·ã‚¹ãƒ†ãƒ  çµ±è¨ˆãƒ¬ãƒãƒ¼ãƒˆ\n';
            report += '=====================================\n\n';
            report += `ç”Ÿæˆæ—¥æ™‚: ${new Date().toLocaleString()}\n\n`;
            
            let totalQuestions = 0;
            modules.forEach(module => {
                const questions = JSON.parse(localStorage.getItem(module + 'Questions') || '[]');
                const count = questions.length;
                totalQuestions += count;
                
                const typeNames = {
                    'vocab': 'èªå½™',
                    'grammar': 'æ–‡æ³•',
                    'reading': 'èª­è§£',
                    'listening': 'ãƒªã‚¹ãƒ‹ãƒ³ã‚°',
                    'summary': 'è¦ç´„'
                };
                
                report += `${typeNames[module]}å•é¡Œ: ${count}ä»¶\n`;
                
                if (count > 0) {
                    const avgDifficulty = questions.reduce((sum, q) => sum + q.difficulty, 0) / count;
                    report += `  å¹³å‡é›£æ˜“åº¦: ${avgDifficulty.toFixed(1)}\n`;
                    
                    const difficulties = [0, 0, 0, 0, 0];
                    questions.forEach(q => {
                        difficulties[q.difficulty - 1]++;
                    });
                    report += `  é›£æ˜“åº¦åˆ†å¸ƒ: åˆç´š(${difficulties[0]}) åˆä¸­ç´š(${difficulties[1]}) ä¸­ç´š(${difficulties[2]}) ä¸­ä¸Šç´š(${difficulties[3]}) ä¸Šç´š(${difficulties[4]})\n`;
                }
                report += '\n';
            });
            
            report += `ç·å•é¡Œæ•°: ${totalQuestions}ä»¶\n`;
            
            const blob = new Blob([report], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            
            const link = document.createElement('a');
            link.href = url;
            link.download = `english-questions-report-${new Date().toISOString().split('T')[0]}.txt`;
            link.click();
            
            URL.revokeObjectURL(url);
            showNotification('ãƒ¬ãƒãƒ¼ãƒˆã‚’ç”Ÿæˆã—ã¾ã—ãŸ');
        }

        function showNotification(message, type = 'success') {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                padding: 15px 20px;
                background: ${type === 'success' ? 'var(--primary-color)' : '#ef4444'};
                color: white;
                border-radius: 8px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.2);
                z-index: 1000;
                transform: translateX(100%);
                transition: transform 0.3s ease;
            `;
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.transform = 'translateX(0)';
            }, 100);
            
            setTimeout(() => {
                notification.style.transform = 'translateX(100%)';
                setTimeout(() => {
                    document.body.removeChild(notification);
                }, 300);
            }, 3000);
        }

        // ãƒšãƒ¼ã‚¸èª­ã¿æ™‚ã«åˆæœŸåŒ–
        document.addEventListener('DOMContentLoaded', function() {
            updateStats();
            displayRecentQuestions();
        });
    </script>
    
    <!-- PWA Service Worker Registration -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('../../sw.js')
                    .then(function(registration) {
                        console.log('PWA: Service Workerç™»éŒ²æˆåŠŸ', registration.scope);
                        
                        // PWAã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ä¿ƒé€²ãƒãƒŠãƒ¼
                        let deferredPrompt;
                        window.addEventListener('beforeinstallprompt', (e) => {
                            e.preventDefault();
                            deferredPrompt = e;
                            
                            // ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãƒãƒŠãƒ¼ã‚’è¡¨ç¤º
                            const installBanner = document.createElement('div');
                            installBanner.innerHTML = `
                                <div style="
                                    position: fixed; 
                                    bottom: 20px; 
                                    left: 50%; 
                                    transform: translateX(-50%);
                                    background: var(--primary-color); 
                                    color: white; 
                                    padding: 15px 20px; 
                                    border-radius: 25px; 
                                    box-shadow: 0 4px 12px rgba(0,0,0,0.3);
                                    z-index: 1000;
                                    font-size: 14px;
                                    display: flex;
                                    align-items: center;
                                    gap: 15px;
                                    max-width: 90vw;
                                ">
                                    ğŸ“± ã“ã®ã‚¢ãƒ—ãƒªã‚’ãƒ›ãƒ¼ãƒ ç”»é¢ã«è¿½åŠ 
                                    <button onclick="installPWA()" style="
                                        background: white; 
                                        color: var(--primary-color); 
                                        border: none; 
                                        padding: 8px 15px; 
                                        border-radius: 20px; 
                                        cursor: pointer;
                                        font-weight: bold;
                                    ">è¿½åŠ </button>
                                    <button onclick="this.parentElement.parentElement.remove()" style="
                                        background: none; 
                                        color: white; 
                                        border: 1px solid white; 
                                        padding: 8px 15px; 
                                        border-radius: 20px; 
                                        cursor: pointer;
                                    ">å¾Œã§</button>
                                </div>
                            `;
                            document.body.appendChild(installBanner);
                            
                            // ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å®Ÿè¡Œé–¢æ•°ã‚’ã‚°ãƒ­ãƒ¼ãƒãƒ«ã«
                            window.installPWA = () => {
                                deferredPrompt.prompt();
                                deferredPrompt.userChoice.then((choiceResult) => {
                                    if (choiceResult.outcome === 'accepted') {
                                        console.log('PWA: ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚’å—ã‘å…¥ã‚Œã¾ã—ãŸ');
                                    }
                                    deferredPrompt = null;
                                    installBanner.remove();
                                });
                            };
                        });
                    })
                    .catch(function(error) {
                        console.log('PWA: Service Workerç™»éŒ²å¤±æ•—', error);
                    });
            });
        }
    </script>
</body>
</html>