<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#f59e0b">
    <title>æ•°å­¦å•é¡Œç®¡ç†ã‚·ã‚¹ãƒ†ãƒ </title>
    
    <!-- PWAå¯¾å¿œ -->
    <link rel="manifest" href="../manifest.json">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="æ•°å­¦å•é¡Œã‚·ã‚¹ãƒ†ãƒ ">
    
    <style>
        :root {
            --primary-color: #f59e0b;
            --secondary-color: #d97706;
            --accent-color: #fbbf24;
            --bg-color: #fffbeb;
            --text-color: #1f2937;
            --border-color: #fed7aa;
            --hover-bg: #fef3c7;
            --card-shadow: 0 4px 20px rgba(245, 158, 11, 0.15);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Hiragino Sans', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            line-height: 1.6;
            -webkit-font-smoothing: antialiased;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 20px;
        }

        .nav-breadcrumb {
            margin-bottom: 30px;
            text-align: center;
        }

        .nav-breadcrumb a {
            color: var(--primary-color);
            text-decoration: none;
            font-weight: 500;
            font-size: 0.95rem;
        }

        .nav-breadcrumb a:hover {
            text-decoration: underline;
        }

        .header {
            text-align: center;
            margin-bottom: 60px;
        }

        .header h1 {
            font-size: 3rem;
            color: var(--primary-color);
            margin-bottom: 20px;
            font-weight: 700;
        }

        .header p {
            font-size: 1.2rem;
            color: #6b7280;
            margin-bottom: 10px;
        }

        .header .system-badge {
            display: inline-block;
            background: var(--primary-color);
            color: white;
            padding: 6px 16px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            margin-top: 15px;
        }

        .modules-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 30px;
            margin-bottom: 50px;
        }

        .module-card {
            background: white;
            border-radius: 16px;
            padding: 30px;
            box-shadow: var(--card-shadow);
            transition: all 0.3s ease;
            text-decoration: none;
            color: inherit;
            display: block;
            border: 2px solid transparent;
            position: relative;
            overflow: hidden;
        }

        .module-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 30px rgba(245, 158, 11, 0.25);
            border-color: var(--primary-color);
        }

        .module-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--primary-color), var(--accent-color));
        }

        .module-icon {
            font-size: 3.5rem;
            margin-bottom: 20px;
            text-align: center;
        }

        .module-title {
            font-size: 1.6rem;
            font-weight: bold;
            margin-bottom: 15px;
            text-align: center;
        }

        .module-subtitle {
            font-size: 0.9rem;
            color: #6b7280;
            text-align: center;
            margin-bottom: 20px;
            font-weight: 500;
        }

        .module-description {
            color: #6b7280;
            line-height: 1.6;
            margin-bottom: 20px;
            font-size: 0.95rem;
        }

        .module-features {
            list-style: none;
            margin-bottom: 20px;
        }

        .module-features li {
            padding: 6px 0;
            color: #6b7280;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .module-features li:before {
            content: "âœ“";
            color: var(--primary-color);
            font-weight: bold;
            font-size: 1rem;
        }

        .module-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid #f3f4f6;
            font-size: 0.85rem;
            color: #9ca3af;
        }

        /* åˆ†é‡åˆ¥ã‚«ãƒ©ãƒ¼ãƒªãƒ³ã‚° */
        .math-i { --module-color: #3b82f6; }
        .math-ii { --module-color: #10b981; }
        .math-iii { --module-color: #f59e0b; }
        .math-a { --module-color: #8b5cf6; }
        .math-b { --module-color: #ef4444; }
        .practice { --module-color: #06b6d4; }

        .math-i .module-icon, .math-i .module-title { color: #3b82f6; }
        .math-ii .module-icon, .math-ii .module-title { color: #10b981; }
        .math-iii .module-icon, .math-iii .module-title { color: #f59e0b; }
        .math-a .module-icon, .math-a .module-title { color: #8b5cf6; }
        .math-b .module-icon, .math-b .module-title { color: #ef4444; }
        .practice .module-icon, .practice .module-title { color: #06b6d4; }

        .stats-section {
            background: white;
            border-radius: 16px;
            padding: 40px;
            box-shadow: var(--card-shadow);
            margin-bottom: 40px;
        }

        .stats-section h3 {
            text-align: center;
            margin-bottom: 30px;
            color: var(--primary-color);
            font-size: 1.5rem;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 30px;
        }

        .stat-item {
            text-align: center;
            padding: 20px;
            background: var(--bg-color);
            border-radius: 12px;
        }

        .stat-number {
            font-size: 2.5rem;
            font-weight: bold;
            color: var(--primary-color);
            margin-bottom: 8px;
        }

        .stat-label {
            color: #6b7280;
            font-size: 0.9rem;
            font-weight: 500;
        }

        .interactive-section {
            background: linear-gradient(135deg, white, #fefbf2);
            border-radius: 16px;
            padding: 40px;
            margin-bottom: 40px;
            box-shadow: var(--card-shadow);
            text-align: center;
        }

        .interactive-section h3 {
            color: var(--primary-color);
            margin-bottom: 20px;
            font-size: 1.4rem;
        }

        .interactive-section p {
            color: #6b7280;
            margin-bottom: 25px;
            line-height: 1.6;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            border: none;
            padding: 14px 30px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            margin: 8px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(245, 158, 11, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(245, 158, 11, 0.4);
        }

        .btn-secondary {
            background: white;
            color: var(--primary-color);
            border: 2px solid var(--primary-color);
            padding: 12px 28px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 500;
            margin: 8px;
            transition: all 0.3s ease;
        }

        .btn-secondary:hover {
            background: var(--primary-color);
            color: white;
        }

        .feature-showcase {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
            margin-top: 30px;
        }

        .feature-card {
            background: rgba(255, 255, 255, 0.8);
            padding: 25px;
            border-radius: 12px;
            text-align: center;
            border: 1px solid #fed7aa;
        }

        .feature-icon {
            font-size: 2.5rem;
            margin-bottom: 15px;
            color: var(--primary-color);
        }

        .feature-title {
            font-weight: 600;
            margin-bottom: 10px;
            color: var(--text-color);
        }

        .feature-desc {
            font-size: 0.9rem;
            color: #6b7280;
            line-height: 1.5;
        }

        .message-area {
            margin-top: 20px;
            padding: 15px;
            border-radius: 8px;
            font-size: 0.95rem;
            display: none;
        }

        .message-area.success {
            background: #d1fae5;
            color: #065f46;
            border: 1px solid #a7f3d0;
            display: block;
        }

        .message-area.error {
            background: #fee2e2;
            color: #991b1b;
            border: 1px solid #fecaca;
            display: block;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #f3f4f6;
            border-radius: 4px;
            overflow: hidden;
            margin: 15px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary-color), var(--accent-color));
            width: 0%;
            transition: width 1s ease;
        }

        .footer {
            text-align: center;
            margin-top: 60px;
            color: #6b7280;
            font-size: 0.9rem;
        }

        /* ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œ */
        @media (max-width: 768px) {
            .container {
                padding: 20px 15px;
            }
            
            .header h1 {
                font-size: 2.2rem;
            }
            
            .modules-grid {
                grid-template-columns: 1fr;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .feature-showcase {
                grid-template-columns: 1fr;
            }
            
            .module-card {
                padding: 25px;
            }
            
            .interactive-section,
            .stats-section {
                padding: 30px 20px;
            }
        }

        @media (max-width: 480px) {
            .header h1 {
                font-size: 1.8rem;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .stat-number {
                font-size: 2rem;
            }
        }

        /* PWAå¯¾å¿œã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .animate-on-scroll {
            animation: fadeInUp 0.6s ease-out;
        }

        /* ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰å¯¾å¿œ */
        @media (prefers-color-scheme: dark) {
            :root {
                --bg-color: #1f2937;
                --text-color: #f9fafb;
            }
            
            .module-card,
            .stats-section,
            .interactive-section {
                background: #374151;
                color: var(--text-color);
            }
            
            .feature-card {
                background: rgba(55, 65, 81, 0.8);
                border-color: #4b5563;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="nav-breadcrumb">
            <a href="../index.html">â† å•é¡Œç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ãƒ¡ã‚¤ãƒ³ã«æˆ»ã‚‹</a>
        </div>

        <div class="header">
            <h1>ğŸ”¢ æ•°å­¦å•é¡Œã‚·ã‚¹ãƒ†ãƒ </h1>
            <p>1A2B3Cä½“ç³»ã«ã‚ˆã‚‹é©æ–°çš„ãªæ•°å­¦å­¦ç¿’ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ </p>
            <p style="font-size: 1rem; color: #9ca3af;">LaTeXå¯¾å¿œ â€¢ åˆ†é‡åˆ¥ç®¡ç† â€¢ ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–å­¦ç¿’</p>
            <span class="system-badge">PWAå¯¾å¿œ â€¢ ãƒ¢ãƒã‚¤ãƒ«æœ€é©åŒ–</span>
        </div>

        <div class="modules-grid">
            <a href="#math1" class="module-card math-i" onclick="openModule('math-i')">
                <div class="module-icon">ğŸ“Š</div>
                <h2 class="module-title">æ•°å­¦I</h2>
                <p class="module-subtitle">I1-I5 åŸºç¤æ•°å­¦é ˜åŸŸ</p>
                <p class="module-description">æ•°ã¨å¼ã€é›†åˆã¨è«–ç†ã€äºŒæ¬¡é–¢æ•°ã€å›³å½¢ã¨è¨ˆé‡ã€ãƒ‡ãƒ¼ã‚¿ã®åˆ†æã‚’æ‰±ã„ã¾ã™</p>
                <ul class="module-features">
                    <li>1A2B3Cå•é¡Œå½¢å¼å¯¾å¿œ</li>
                    <li>LaTeXæ•°å¼å…¥åŠ›</li>
                    <li>å¤šè‚¢é¸æŠãƒ»è¨˜è¿°ä½µç”¨</li>
                    <li>æ®µéšçš„é›£æ˜“åº¦è¨­å®š</li>
                </ul>
                <div class="module-meta">
                    <span>ğŸ“š 5åˆ†é‡</span>
                    <span id="math1-count">0å•</span>
                </div>
            </a>

            <a href="#math2" class="module-card math-ii" onclick="openModule('math-ii')">
                <div class="module-icon">ğŸ“ˆ</div>
                <h2 class="module-title">æ•°å­¦II</h2>
                <p class="module-subtitle">II1-II5 å¿œç”¨æ•°å­¦é ˜åŸŸ</p>
                <p class="module-description">å¼ã¨è¨¼æ˜ã€è¤‡ç´ æ•°ã¨æ–¹ç¨‹å¼ã€å›³å½¢ã¨æ–¹ç¨‹å¼ã€ä¸‰è§’é–¢æ•°ã€æŒ‡æ•°ãƒ»å¯¾æ•°é–¢æ•°ã‚’æ‰±ã„ã¾ã™</p>
                <ul class="module-features">
                    <li>é«˜åº¦ãªæ•°å¼å‡¦ç†</li>
                    <li>ã‚°ãƒ©ãƒ•ãƒ»å›³å½¢å¯¾å¿œ</li>
                    <li>è¨¼æ˜å•é¡Œã‚µãƒãƒ¼ãƒˆ</li>
                    <li>è¨ˆç®—éç¨‹è©•ä¾¡</li>
                </ul>
                <div class="module-meta">
                    <span>ğŸ“ˆ 5åˆ†é‡</span>
                    <span id="math2-count">0å•</span>
                </div>
            </a>

            <a href="#math3" class="module-card math-iii" onclick="openModule('math-iii')">
                <div class="module-icon">âˆ«</div>
                <h2 class="module-title">æ•°å­¦III</h2>
                <p class="module-subtitle">III1-III3 ç™ºå±•æ•°å­¦é ˜åŸŸ</p>
                <p class="module-description">æ¥µé™ã€å¾®åˆ†æ³•ã€ç©åˆ†æ³•ã®é«˜åº¦ãªæ•°å­¦æ¦‚å¿µã‚’æ‰±ã„ã¾ã™</p>
                <ul class="module-features">
                    <li>æ¥µé™ãƒ»å¾®ç©åˆ†å¯¾å¿œ</li>
                    <li>é«˜æ¬¡æ•°å¼å‡¦ç†</li>
                    <li>å¿œç”¨å•é¡Œé‡è¦–</li>
                    <li>è«–ç†çš„æ€è€ƒè©•ä¾¡</li>
                </ul>
                <div class="module-meta">
                    <span>âˆ 3åˆ†é‡</span>
                    <span id="math3-count">0å•</span>
                </div>
            </a>

            <a href="#matha" class="module-card math-a" onclick="openModule('math-a')">
                <div class="module-icon">ğŸ²</div>
                <h2 class="module-title">æ•°å­¦A</h2>
                <p class="module-subtitle">A1-A3 å®Ÿç”¨æ•°å­¦é ˜åŸŸ</p>
                <p class="module-description">å ´åˆã®æ•°ã¨ç¢ºç‡ã€å›³å½¢ã®æ€§è³ªã€æ•´æ•°ã®æ€§è³ªã‚’æ‰±ã„ã¾ã™</p>
                <ul class="module-features">
                    <li>ç¢ºç‡ãƒ»çµ±è¨ˆå•é¡Œ</li>
                    <li>å›³å½¢è¨¼æ˜ã‚µãƒãƒ¼ãƒˆ</li>
                    <li>æ•´æ•°å•é¡Œå¯¾å¿œ</li>
                    <li>å®Ÿç”Ÿæ´»å¿œç”¨é‡è¦–</li>
                </ul>
                <div class="module-meta">
                    <span>ğŸ¯ 3åˆ†é‡</span>
                    <span id="matha-count">0å•</span>
                </div>
            </a>

            <a href="#mathb" class="module-card math-b" onclick="openModule('math-b')">
                <div class="module-icon">ğŸ“</div>
                <h2 class="module-title">æ•°å­¦B</h2>
                <p class="module-subtitle">B1-B3 çµ±åˆæ•°å­¦é ˜åŸŸ</p>
                <p class="module-description">æ•°åˆ—ã€ãƒ™ã‚¯ãƒˆãƒ«ã€çµ±è¨ˆçš„ãªæ¨æ¸¬ã‚’æ‰±ã„ã¾ã™</p>
                <ul class="module-features">
                    <li>æ•°åˆ—ãƒ‘ã‚¿ãƒ¼ãƒ³èªè­˜</li>
                    <li>ãƒ™ã‚¯ãƒˆãƒ«å›³å½¢å‡¦ç†</li>
                    <li>çµ±è¨ˆçš„æ¨æ¸¬</li>
                    <li>ãƒ‡ãƒ¼ã‚¿è§£æå¯¾å¿œ</li>
                </ul>
                <div class="module-meta">
                    <span>ğŸ“Š 3åˆ†é‡</span>
                    <span id="mathb-count">0å•</span>
                </div>
            </a>

            <a href="math-manager.html" class="module-card practice">
                <div class="module-icon">ğŸ¯</div>
                <h2 class="module-title">çµ±åˆç®¡ç†ã‚·ã‚¹ãƒ†ãƒ </h2>
                <p class="module-subtitle">å…¨åˆ†é‡çµ±åˆ â€¢ é«˜åº¦ç®¡ç†æ©Ÿèƒ½</p>
                <p class="module-description">å…¨åˆ†é‡ã‚’çµ±åˆã—ãŸé«˜æ©Ÿèƒ½ãªå•é¡Œç®¡ç†ãƒ»ç·´ç¿’ã‚·ã‚¹ãƒ†ãƒ ã§ã™</p>
                <ul class="module-features">
                    <li>å…¨åˆ†é‡å¯¾å¿œå•é¡Œä½œæˆ</li>
                    <li>çµ±è¨ˆæƒ…å ±ãƒ»åˆ†æ</li>
                    <li>ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆæ©Ÿèƒ½</li>
                    <li>ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ç®¡ç†</li>
                </ul>
                <div class="module-meta">
                    <span>ğŸ”§ ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ </span>
                    <span>é«˜æ©Ÿèƒ½ç‰ˆ</span>
                </div>
            </a>
        </div>

        <div class="stats-section animate-on-scroll">
            <h3>ğŸ“Š ã‚·ã‚¹ãƒ†ãƒ çµ±è¨ˆæƒ…å ±</h3>
            <div class="stats-grid">
                <div class="stat-item">
                    <div class="stat-number" id="totalQuestions">0</div>
                    <div class="stat-label">ç·å•é¡Œæ•°</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number">19</div>
                    <div class="stat-label">æ•°å­¦åˆ†é‡</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number">1A2B3C</div>
                    <div class="stat-label">å•é¡Œå½¢å¼</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="avgDifficulty">0.0</div>
                    <div class="stat-label">å¹³å‡é›£æ˜“åº¦</div>
                </div>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
        </div>

        <div class="interactive-section animate-on-scroll">
            <h3>ğŸš€ ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–å­¦ç¿’ä½“é¨“</h3>
            <p>1A2B3Cä½“ç³»ã«åŸºã¥ãé©æ–°çš„ãªæ•°å­¦å­¦ç¿’ã‚·ã‚¹ãƒ†ãƒ ã§ã€ã‚ãªãŸã®ç†æƒ³ã‚’å®Ÿç¾ã—ã¾ã™</p>
            
            <div class="feature-showcase">
                <div class="feature-card">
                    <div class="feature-icon">ğŸ“±</div>
                    <div class="feature-title">ãƒ¢ãƒã‚¤ãƒ«ãƒ•ã‚¡ãƒ¼ã‚¹ãƒˆ</div>
                    <div class="feature-desc">ã‚¹ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ³ã§ã®å­¦ç¿’ä½“é¨“ã‚’æœ€é©åŒ–</div>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">ğŸ¨</div>
                    <div class="feature-title">PWAå¯¾å¿œ</div>
                    <div class="feature-desc">ã‚¢ãƒ—ãƒªãƒ©ã‚¤ã‚¯ãªä½¿ç”¨æ„Ÿã¨ã‚ªãƒ•ãƒ©ã‚¤ãƒ³å¯¾å¿œ</div>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">ğŸ¤</div>
                    <div class="feature-title">ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£é§†å‹•</div>
                    <div class="feature-desc">ãƒ¦ãƒ¼ã‚¶ãƒ¼ç”Ÿæˆã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã¨ãƒ”ã‚¢ãƒ¬ãƒ“ãƒ¥ãƒ¼</div>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">ğŸ”’</div>
                    <div class="feature-title">ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼é‡è¦–</div>
                    <div class="feature-desc">å³æ ¼ãªãƒ‡ãƒ¼ã‚¿ç®¡ç†ã¨å€‹äººæƒ…å ±ä¿è­·</div>
                </div>
            </div>
            
            <div style="margin-top: 30px;">
                <button class="btn-primary" onclick="loadSampleData()">ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã‚’ä½“é¨“</button>
                <button class="btn-secondary" onclick="showSystemInfo()">ã‚·ã‚¹ãƒ†ãƒ æƒ…å ±</button>
            </div>
            
            <div id="message-area" class="message-area"></div>
        </div>

        <div class="footer">
            <p>&copy; 2025 æ•°å­¦å•é¡Œç®¡ç†ã‚·ã‚¹ãƒ†ãƒ  - ç†æƒ³ã®å­¦ç¿’ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ </p>
            <p style="margin-top: 5px; font-size: 0.8rem;">1A2B3Cä½“ç³» â€¢ LaTeXå¯¾å¿œ â€¢ PWA â€¢ ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£é§†å‹•</p>
        </div>
    </div>

    <script>
        // PWAå¯¾å¿œ
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('../sw.js').catch(console.error);
        }

        // çµ±è¨ˆæƒ…å ±ã®æ›´æ–°
        function updateStats() {
            try {
                const questions = JSON.parse(localStorage.getItem('mathQuestions') || '[]');
                const totalQuestions = questions.length;
                
                // åŸºæœ¬çµ±è¨ˆ
                document.getElementById('totalQuestions').textContent = totalQuestions;
                
                // åˆ†é‡åˆ¥çµ±è¨ˆ
                const fieldStats = {};
                let totalDifficulty = 0;
                
                questions.forEach(q => {
                    const field = q.fieldCode || '';
                    fieldStats[field] = (fieldStats[field] || 0) + 1;
                    
                    // é›£æ˜“åº¦è¨ˆç®— (A=1, B=2, C=3, D=4)
                    const difficultyValue = { A: 1, B: 2, C: 3, D: 4 }[q.difficultyLevel] || 2;
                    totalDifficulty += difficultyValue;
                });
                
                // å¹³å‡é›£æ˜“åº¦
                const avgDifficulty = totalQuestions > 0 ? (totalDifficulty / totalQuestions).toFixed(1) : '0.0';
                document.getElementById('avgDifficulty').textContent = avgDifficulty;
                
                // åˆ†é‡åˆ¥ã‚«ã‚¦ãƒ³ãƒˆæ›´æ–°
                updateFieldCounts(fieldStats);
                
                // ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼æ›´æ–°
                const targetQuestions = 100;
                const progress = Math.min((totalQuestions / targetQuestions) * 100, 100);
                document.getElementById('progressFill').style.width = progress + '%';
                
                console.log(`æ•°å­¦å•é¡Œçµ±è¨ˆ: ${totalQuestions}å•, å¹³å‡é›£æ˜“åº¦: ${avgDifficulty}`);
                
            } catch (error) {
                console.error('çµ±è¨ˆæ›´æ–°ã‚¨ãƒ©ãƒ¼:', error);
            }
        }

        function updateFieldCounts(fieldStats) {
            // å„åˆ†é‡ã®ã‚«ã‚¦ãƒ³ãƒˆæ›´æ–°
            const fieldMappings = {
                'math1-count': ['I1', 'I2', 'I3', 'I4', 'I5'],
                'math2-count': ['II1', 'II2', 'II3', 'II4', 'II5'],
                'math3-count': ['III1', 'III2', 'III3'],
                'matha-count': ['A1', 'A2', 'A3'],
                'mathb-count': ['B1', 'B2', 'B3']
            };
            
            Object.entries(fieldMappings).forEach(([elementId, fields]) => {
                const count = fields.reduce((sum, field) => sum + (fieldStats[field] || 0), 0);
                const element = document.getElementById(elementId);
                if (element) {
                    element.textContent = count + 'å•';
                }
            });
        }

        function openModule(moduleType) {
            // å°†æ¥çš„ã«å€‹åˆ¥ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãƒšãƒ¼ã‚¸ã«é·ç§»
            const message = `${moduleType}ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¯æº–å‚™ä¸­ã§ã™ã€‚ç¾åœ¨ã¯çµ±åˆç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ã‚’ã”åˆ©ç”¨ãã ã•ã„ã€‚`;
            showMessage(message, 'info');
        }

        function loadSampleData() {
            try {
                // ã‚µãƒ³ãƒ—ãƒ«æ•°å­¦å•é¡Œãƒ‡ãƒ¼ã‚¿
                const sampleQuestions = [
                    {
                        id: 'sample_math_I1_001',
                        fieldCode: 'I1',
                        difficultyLevel: 'A',
                        difficultyAmount: '2',
                        title: 'çµ¶å¯¾å€¤ã®è¨ˆç®—',
                        answerFormat: 'A1',
                        questionText: 'æ¬¡ã®å¼ã®å€¤ã‚’æ±‚ã‚ãªã•ã„ã€‚$|3-7|+|2-5|$',
                        choices: ['7', '5', '6', '8'],
                        correctAnswer: 0,
                        estimatedTime: 3,
                        explanation: '$|3-7|=4$, $|2-5|=3$ ã‚ˆã‚Š $4+3=7$',
                        createdAt: new Date().toISOString()
                    },
                    {
                        id: 'sample_math_I3_001',
                        fieldCode: 'I3',
                        difficultyLevel: 'B',
                        difficultyAmount: '3',
                        title: 'äºŒæ¬¡é–¢æ•°ã®æœ€å¤§ãƒ»æœ€å°',
                        answerFormat: 'F1',
                        questionText: 'äºŒæ¬¡é–¢æ•° $y = -2x^2 + 8x - 5$ ã®æœ€å¤§å€¤ã‚’æ±‚ã‚ãªã•ã„ã€‚',
                        estimatedTime: 5,
                        explanation: '$y = -2(x^2 - 4x) - 5 = -2(x-2)^2 + 3$ ã‚ˆã‚Šã€æœ€å¤§å€¤ã¯3',
                        createdAt: new Date().toISOString()
                    },
                    {
                        id: 'sample_math_A1_001',
                        fieldCode: 'A1',
                        difficultyLevel: 'C',
                        difficultyAmount: '3',
                        title: 'é †åˆ—ã¨çµ„åˆã›',
                        answerFormat: 'A1',
                        questionText: '6äººã‹ã‚‰3äººã‚’é¸ã‚“ã§ä¸€åˆ—ã«ä¸¦ã¹ã‚‹é †åˆ—ã®æ•°ã¯ã„ãã‚‰ã‹ã€‚',
                        choices: ['20', '120', '216', '720'],
                        correctAnswer: 1,
                        estimatedTime: 4,
                        explanation: '${}_6P_3 = 6 \\times 5 \\times 4 = 120$',
                        createdAt: new Date().toISOString()
                    }
                ];
                
                // æ—¢å­˜ã®ãƒ‡ãƒ¼ã‚¿ã¨çµåˆ
                const existingQuestions = JSON.parse(localStorage.getItem('mathQuestions') || '[]');
                const combinedQuestions = [...existingQuestions];
                
                // é‡è¤‡ãƒã‚§ãƒƒã‚¯ã—ã¦è¿½åŠ 
                sampleQuestions.forEach(sample => {
                    if (!combinedQuestions.find(q => q.id === sample.id)) {
                        combinedQuestions.push(sample);
                    }
                });
                
                localStorage.setItem('mathQuestions', JSON.stringify(combinedQuestions));
                updateStats();
                
                showMessage('ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸï¼3ã¤ã®æ•°å­¦å•é¡ŒãŒè¿½åŠ ã•ã‚Œã¾ã—ãŸã€‚', 'success');
                
            } catch (error) {
                showMessage('ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸã€‚', 'error');
                console.error('Sample data loading error:', error);
            }
        }

        function showSystemInfo() {
            const info = `
                ğŸ“Š æ•°å­¦å•é¡Œç®¡ç†ã‚·ã‚¹ãƒ†ãƒ  v2.0
                ğŸ”¢ 1A2B3Cå•é¡Œå½¢å¼å¯¾å¿œ
                ğŸ“± PWAãƒ»ãƒ¢ãƒã‚¤ãƒ«ãƒ•ã‚¡ãƒ¼ã‚¹ãƒˆè¨­è¨ˆ
                ğŸ¯ å…¨19åˆ†é‡å¯¾å¿œ (I1-B3)
                âœ¨ LaTeXæ•°å¼ã‚µãƒãƒ¼ãƒˆ
                ğŸ¤ ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£é§†å‹•å­¦ç¿’
            `;
            showMessage(info, 'success');
        }

        function showMessage(message, type = 'success') {
            const messageArea = document.getElementById('message-area');
            messageArea.textContent = message;
            messageArea.className = `message-area ${type}`;
            
            // 5ç§’å¾Œã«è‡ªå‹•ã§éè¡¨ç¤º
            setTimeout(() => {
                messageArea.style.display = 'none';
            }, 5000);
        }

        // ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³åŠ¹æœ
        function animateOnScroll() {
            const elements = document.querySelectorAll('.animate-on-scroll');
            elements.forEach(el => {
                const rect = el.getBoundingClientRect();
                if (rect.top < window.innerHeight && rect.bottom > 0) {
                    el.style.animation = 'fadeInUp 0.6s ease-out';
                }
            });
        }

        // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼
        document.addEventListener('DOMContentLoaded', function() {
            updateStats();
            animateOnScroll();
        });

        window.addEventListener('scroll', animateOnScroll);
        window.addEventListener('storage', updateStats);

        // ã‚¿ãƒƒãƒã‚¤ãƒ™ãƒ³ãƒˆå¯¾å¿œï¼ˆãƒ¢ãƒã‚¤ãƒ«ï¼‰
        if ('ontouchstart' in window) {
            document.body.classList.add('touch-device');
        }
    </script>
</body>
</html>