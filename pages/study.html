<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#fef5e7">
    <title>Â≠¶Áøí„Éé„Éº„Éà</title>
    <link rel="apple-touch-icon" href="https://pub-d59d6e46c3154423956f648f8df909ae.r2.dev/61203.jpg">
    <link rel="icon" href="https://pub-d59d6e46c3154423956f648f8df909ae.r2.dev/61203.jpg">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Klee+One:wght@400;600&family=Zen+Kurenaido&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="../css/theme-toggle.css">
    <link rel="stylesheet" href="../css/rating-system.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    <!-- Material Symbols -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@24,400,0,0">
    <!-- Tabler Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@tabler/icons@latest/iconfont/tabler-icons.min.css">
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <script src="../js/theme.js"></script>
    <script src="../js/core/unified-api-client.js"></script>
    <script src="../js/core/auth-manager.js"></script>
    <script src="../js/components/sidebar.js"></script>
</head>

<body>
    <div class="notebook">
        <div class="doodle-bg doodle-star">‚òÖ</div>
        <div class="doodle-bg doodle-heart">‚ô°</div>
        <div class="doodle-bg doodle-note">‚ô™</div>
        <div class="doodle-bg doodle-smile">‚ò∫</div>
        <div class="doodle-bg doodle-check">‚úì</div>
        <div class="doodle-bg doodle-arrow">‚Üí</div>
        <div class="doodle-bg doodle-circle">‚óØ</div>
        <div class="doodle-bg doodle-flower">‚úø</div>
        <div class="doodle-bg doodle-sun">‚òÄ</div>
        <div class="doodle-bg doodle-cloud">‚òÅ</div>
        <div class="doodle-bg doodle-pencil">‚úè</div>
        <div class="doodle-bg doodle-book"><span class="material-symbols-outlined icon">menu_book</span></div>
        <div class="doodle-bg doodle-rocket"><span class="material-symbols-rounded icon">rocket_launch</span></div>
        <div class="doodle-bg doodle-light"><span class="material-symbols-rounded icon">lightbulb</span></div>
        <div class="doodle-bg doodle-trophy">üèÜ</div>

        <div class="scribble scribble-1"></div>
        <div class="scribble scribble-2"></div>
        <div class="scribble scribble-3"></div>
        
        <svg class="doodle-line doodle-line-1" width="100" height="100">
            <path d="M 10 50 Q 30 20, 50 50 T 90 50" stroke="#d4a574" stroke-width="2" fill="none" opacity="0.1"/>
        </svg>
        <svg class="doodle-line doodle-line-2" width="80" height="80">
            <circle cx="40" cy="40" r="30" stroke="#d4a574" stroke-width="2" fill="none" opacity="0.1" stroke-dasharray="5,5"/>
        </svg>

        <div class="container">
            <div class="main-content">
                <!-- ÂÖ±ÈÄö„Éò„ÉÉ„ÉÄ„ÉºÔºàÂÖ®„É¢„Éº„ÉâÂÖ±ÈÄöÔºâ -->
                <h1 id="subjectTitle">Â≠¶Áøí</h1>
                <button class="back-btn" id="backBtn">‚Üê Êàª„Çã</button>

                <!-- ÈÄöÂ∏∏Â≠¶Áøí„É¢„Éº„Éâ -->
                <div class="study-area">
                <div class="card">
                    <div class="underline"></div>
                    <p class="question" id="question">Ê¨°„ÅÆÂïèÈ°å„ÇíÊäº„Åó„Å¶„Çπ„Çø„Éº„Éà</p>
                    <div class="underline"></div>
                    <div class="doodle">‚úé</div>
                </div>

                <div id="speakBtnArea" class="speak-area hidden">
                    <button id="speakBtn" onclick="speakAgain()">Èü≥Â£∞„ÇíÂÜçÁîü</button>
                </div>

                <div class="choices" id="choices">
                    <button class="choice-btn" onclick="selectChoice(0)">A</button>
                    <button class="choice-btn" onclick="selectChoice(1)">B</button>
                    <button class="choice-btn" onclick="selectChoice(2)">C</button>
                    <button class="choice-btn" onclick="selectChoice(3)">D</button>
                    <button class="choice-btn" onclick="selectChoice(4)">E</button>
                </div>

                <!-- Êï∞Â≠¶Áî®„ÅÆÊï∞ÂÄ§ÂÖ•ÂäõUI -->
                <div class="math-input-area hidden" id="mathInputArea">
                    <div class="help-button-container" style="text-align: right; margin-bottom: 10px;">
                        <button class="help-btn" onclick="showMathRules()" style="background: transparent; border: 1px solid #666; color: #666; padding: 5px 15px; border-radius: 20px; cursor: pointer; font-size: 14px;">
                            ? „É´„Éº„É´
                        </button>
                    </div>
                    <div class="numeric-input-container" style="display: flex; align-items: center; justify-content: center; gap: 15px; margin: 20px 0;">
                        <label for="mathAnswerInput" style="font-size: 18px; font-weight: 600;">Á≠î„Åà:</label>
                        <input type="number" id="mathAnswerInput" placeholder="Êï∞ÂÄ§„ÇíÂÖ•Âäõ"
                               style="width: 200px; padding: 12px; font-size: 18px; border: 2px solid #ddd; border-radius: 8px; text-align: center;"
                               onkeypress="if(event.key === 'Enter') submitMathAnswer()">
                        <button class="submit-math-btn" onclick="submitMathAnswer()"
                                style="padding: 12px 30px; background: #4f46e5; color: white; border: none; border-radius: 8px; cursor: pointer; font-size: 16px; font-weight: 600;">
                            Ëß£Á≠î„Åô„Çã
                        </button>
                    </div>
                </div>

                <div class="result hidden" id="result">
                    <p class="result-text" id="resultText"></p>
                    <p class="correct-answer" id="correctAnswer"></p>
                    <div class="explanation-box" id="explanationBox" style="display: none; margin: 20px 0; padding: 15px; background: #f8f9fa; border-left: 4px solid #4f46e5; border-radius: 8px;">
                        <h4 style="margin-bottom: 10px; color: #4f46e5; font-size: 16px;">Ëß£Ë™¨</h4>
                        <p id="explanationText" style="line-height: 1.8; color: #333;"></p>
                    </div>
                    <button class="next-btn" onclick="nextQuestion()">Ê¨°„ÅÆÂïèÈ°å ‚Üí</button>
                </div>

                <!-- Ë©ï‰æ°„Éª„Ç≥„É°„É≥„Éà„Çª„ÇØ„Ç∑„Éß„É≥ -->
                <div class="rating-section hidden" id="ratingSection">
                    <div class="card">
                        <div class="underline"></div>
                        <h3 style="margin-bottom: 20px; color: var(--text-primary);">
                            <span class="material-symbols-outlined" style="vertical-align: middle; margin-right: 8px;">star</span>
                            „Åì„ÅÆÂïèÈ°å„ÇíË©ï‰æ°
                        </h3>
                        <div class="rating-container" id="ratingContainer">
                            <!-- Ë©ï‰æ°„Ç∑„Çπ„ÉÜ„É†„Åå„Åì„Åì„Å´Ë™≠„ÅøËæº„Åæ„Çå„Çã -->
                        </div>
                    </div>
                </div>

                <div class="stats">
                    <p class="stat">ÂïèÈ°åÊï∞: <span id="count">0</span></p>
                    <p class="stat">Ê≠£Ëß£: <span id="correct">0</span></p>
                    <p class="stat">Ê≠£Ëß£Áéá: <span id="accuracy">-</span></p>
                </div>
                </div>

                <!-- Ëã±‰ΩúÊñá„É¢„Éº„Éâ -->
                <div id="writing-container" class="writing-area" style="display: none;">
                    <!-- EnglishCompositionSystem „Åå„Åì„Åì„Å´Ë™≠„ÅøËæº„Åæ„Çå„Çã -->
                </div>
            </div>

            <!-- Âè≥„Çµ„Ç§„Éâ„Éê„ÉºÔºàÁµ±‰∏Ä„Ç≥„É≥„Éù„Éº„Éç„É≥„Éà„Å´„Çà„ÇäËá™ÂãïÁîüÊàêÔºâ -->
            <div class="right-sidebar">
            </div>
        </div>
    </div>

    <!-- Êï∞Â≠¶„É´„Éº„É´Ë°®Á§∫„É¢„Éº„ÉÄ„É´ -->
    <div id="mathRulesModal" class="modal" style="display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.5);">
        <div class="modal-content" style="background-color: #ffffff; margin: 10% auto; padding: 30px; border-radius: 12px; width: 80%; max-width: 600px; box-shadow: 0 4px 20px rgba(0,0,0,0.2);">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                <h3 style="color: #333; margin: 0;">Êï∞Â≠¶ÂïèÈ°å„ÅÆËß£Á≠î„É´„Éº„É´</h3>
                <span class="close" onclick="closeMathRules()" style="font-size: 28px; font-weight: bold; color: #aaa; cursor: pointer;">&times;</span>
            </div>
            <div style="line-height: 1.8; color: #555;">
                <p style="margin-bottom: 15px; font-weight: 600; color: #4f46e5;">Á≠î„Åà„ÅØÊï∞ÂÄ§„ÅÆ„Åø„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ</p>
                <div style="background: #f0f4ff; padding: 15px; border-radius: 8px; margin-bottom: 15px; border: 1px solid #d0d9ff;">
                    <p style="margin-bottom: 10px; font-weight: 600; color: #333;">Â§âÊèõ„É´„Éº„É´Ôºö</p>
                    <ul style="margin: 0; padding-left: 20px;">
                        <li style="margin-bottom: 8px;">ÊúâÁêÜÂåñ„Åï„Çå„Åü„ÄÅÁ¥ÑÂàÜ„Åï„Çå„ÅüÂΩ¢„ÅßË®àÁÆó</li>
                        <li style="margin-bottom: 8px;">ÂàÜÊï∞ \(\frac{a}{b}\) ‚Üí \(a + b\)</li>
                        <li style="margin-bottom: 8px;">\(\sqrt{n}\) ‚Üí \(n\)</li>
                        <li style="margin-bottom: 8px;">\(\log n\) ‚Üí \(n\)„ÄÅ\(\log(1/n)\) ‚Üí \(1 + n\)</li>
                        <li style="margin-bottom: 8px;">„Éû„Ç§„Éä„Çπ„ÅØÁÑ°Ë¶ñ</li>
                    </ul>
                </div>
                <div style="background: #fffbeb; padding: 15px; border-radius: 8px; border: 1px solid #fde68a;">
                    <p style="margin: 0; font-weight: 600; margin-bottom: 10px; color: #92400e;">‰æãÔºö</p>
                    <p style="margin: 5px 0; color: #333;">\(\frac{3}{4} + \sqrt{3} + \log 3\) „ÅÆÂ†¥Âêà</p>
                    <p style="margin: 5px 0; color: #4f46e5; font-weight: 600;">‚Üí \(3 + 4 + 3 + 3 = 13\) „Å®ÂÖ•Âäõ</p>
                </div>
            </div>
        </div>
    </div>

    <!-- „ÇÇ„Å°„ÇÇ„Å°ÊâãÊõ∏„ÅçÈ¢®Áå´ÔºàËÉåÊôØË£ÖÈ£æÔºâ: ÁôΩÈªíÁâà -->
    <div style="position: fixed; bottom: 20px; right: 20px; opacity: 0.25; pointer-events: none; z-index: 10; will-change: transform;">
        <svg width="140" height="140" viewBox="0 0 140 140" xmlns="http://www.w3.org/2000/svg">
            <defs>
                <!-- „ÇÑ„Çè„Çâ„Åã„ÅÑ„Ç∞„É©„Éá„Éº„Ç∑„Éß„É≥„ÅÆÂÆöÁæ© -->
                <linearGradient id="bodyGrad" x1="0%" y1="0%" x2="100%" y2="100%">
                    <stop offset="0%" style="stop-color:#e0e0e0;stop-opacity:1" />
                    <stop offset="100%" style="stop-color:#d0d0d0;stop-opacity:1" />
                </linearGradient>
                <filter id="softShadow" x="-20%" y="-20%" width="140%" height="140%">
                    <feGaussianBlur in="SourceAlpha" stdDeviation="2" />
                    <feOffset dx="1" dy="2" result="offsetblur" />
                    <feComponentTransfer>
                        <feFuncA type="linear" slope="0.1" />
                    </feComponentTransfer>
                    <feMerge>
                        <feMergeNode />
                        <feMergeNode in="SourceGraphic" />
                    </feMerge>
                </filter>
            </defs>

            <g transform="translate(10, 10)" filter="url(#softShadow)">

                <!-- ‚ñ† „Åó„Å£„ÅΩ -->
                <path d="M 95 95
                         C 110 95, 125 85, 120 65
                         C 115 45, 100 50, 95 60"
                      fill="none" stroke="#bbb" stroke-width="8" stroke-linecap="round" stroke-linejoin="round"/>

                <!-- ‚ñ† ‰Ωì -->
                <path d="M 35 100
                         C 25 100, 20 80, 35 65
                         C 50 50, 90 50, 105 65
                         C 120 80, 115 100, 105 100
                         Z"
                      fill="url(#bodyGrad)" stroke="#888" stroke-width="2.5" stroke-linejoin="round"/>

                <!-- ‚ñ† ÂâçË∂≥ÔºàÂ∑¶Ôºâ -->
                <ellipse cx="55" cy="100" rx="9" ry="7" fill="#e0e0e0" stroke="#888" stroke-width="2"/>
                <path d="M 55 96 L 55 99" stroke="#888" stroke-width="1.5" stroke-linecap="round"/>

                <!-- ‚ñ† ÂâçË∂≥ÔºàÂè≥Ôºâ -->
                <ellipse cx="85" cy="100" rx="9" ry="7" fill="#e0e0e0" stroke="#888" stroke-width="2"/>
                <path d="M 85 96 L 85 99" stroke="#888" stroke-width="1.5" stroke-linecap="round"/>

                <!-- ‚ñ† È†≠ÈÉ® -->
                <path d="M 35 55
                         C 35 30, 105 30, 105 55
                         C 105 75, 90 82, 70 82
                         C 50 82, 35 75, 35 55 Z"
                      fill="#e0e0e0" stroke="#888" stroke-width="2.5" stroke-linejoin="round"/>

                <!-- ‚ñ† Â∑¶ËÄ≥ -->
                <path d="M 42 38
                         C 35 20, 55 15, 60 32"
                      fill="#e0e0e0" stroke="#888" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>
                <!-- ËÄ≥„ÅÆ‰∏≠ -->
                <path d="M 45 36 C 42 28, 50 25, 55 34" fill="#d0d0d0" stroke="none"/>

                <!-- ‚ñ† Âè≥ËÄ≥ -->
                <path d="M 98 38
                         C 105 20, 85 15, 80 32"
                      fill="#e0e0e0" stroke="#888" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>
                <!-- ËÄ≥„ÅÆ‰∏≠ -->
                <path d="M 95 36 C 98 28, 90 25, 85 34" fill="#d0d0d0" stroke="none"/>

                <!-- ‚ñ† È°î„ÅÆ„Éë„Éº„ÉÑ -->
                <g transform="translate(0, 5)">
                    <!-- Â∑¶ÁõÆ -->
                    <circle cx="55" cy="50" r="5" fill="#666"/>
                    <circle cx="53" cy="48" r="1.5" fill="#aaa" opacity="0.6"/>

                    <!-- Âè≥ÁõÆ -->
                    <circle cx="85" cy="50" r="5" fill="#666"/>
                    <circle cx="83" cy="48" r="1.5" fill="#aaa" opacity="0.6"/>

                    <!-- „Åª„Å£„Å∫ -->
                    <ellipse cx="48" cy="58" rx="5" ry="3" fill="#bbb" opacity="0.3"/>
                    <ellipse cx="92" cy="58" rx="5" ry="3" fill="#bbb" opacity="0.3"/>

                    <!-- Âè£„Å®Èºª -->
                    <path d="M 68 56 Q 70 58 72 56" fill="none" stroke="#666" stroke-width="1.5" stroke-linecap="round"/>
                    <path d="M 70 58 Q 65 63 60 60" fill="none" stroke="#666" stroke-width="1.5" stroke-linecap="round"/>
                    <path d="M 70 58 Q 75 63 80 60" fill="none" stroke="#666" stroke-width="1.5" stroke-linecap="round"/>
                </g>

                <!-- ‚ñ† „Å≤„Åí -->
                <g stroke="#999" stroke-width="1.5" stroke-linecap="round" fill="none">
                    <path d="M 45 55 Q 35 52 30 50" />
                    <path d="M 45 58 Q 35 60 30 62" />
                    <path d="M 95 55 Q 105 52 110 50" />
                    <path d="M 95 58 Q 105 60 110 62" />
                </g>

            </g>
        </svg>
    </div>

    <script src="../js/features/rating-system.js"></script>
    <script src="../js/features/study.js"></script>
    <script src="../js/features/sidebar-toggle.js"></script>
</body>

</html>
