<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>English Quick Practice - „Åú„Çç</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200"
        rel="stylesheet">
    <link rel="stylesheet" href="../css/base.css">
    <link rel="stylesheet" href="../css/components.css">
    <link rel="stylesheet" href="../css/ui.css">
    <style>
        /* Ëã±Ë™û„É¢„Ç∏„É•„Éº„É´Âõ∫Êúâ„ÅÆ„Çπ„Çø„Ç§„É´ */
        .page-title {
            font-size: 1.125rem;
            font-weight: 700;
            text-align: center;
            flex: 1;
        }

        .back-button {
            background: none;
            border: 1px solid var(--border-color);
            color: var(--text-color);
            padding: 8px;
            border-radius: 4px;
            cursor: pointer;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-decoration: none;
            transition: var(--transition);
        }

        .back-button:hover {
            background: var(--bg-subtle);
            border-color: var(--accent-color);
        }

        .categories-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 16px;
            margin-bottom: 32px;
        }

        @media (min-width: 768px) {
            .categories-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 20px;
            }
        }

        .category-card {
            background: var(--bg-color);
            border: 2px solid var(--border-color);
            border-radius: 12px;
            padding: 24px 20px;
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
        }

        .category-card:hover {
            border-color: var(--primary-color);
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }

        .category-icon {
            font-size: 2.5rem;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .category-title {
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .category-description {
            color: var(--accent-color);
            font-size: 0.875rem;
            margin-bottom: 16px;
        }

        .level-buttons {
            display: flex;
            justify-content: center;
            gap: 8px;
            flex-wrap: wrap;
        }

        .level-btn {
            background: var(--bg-color);
            border: 2px solid var(--border-color);
            padding: 12px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.875rem;
            font-weight: 500;
            min-height: 44px;
            transition: var(--transition);
        }

        .level-btn:hover {
            border-color: var(--primary-color);
            background: rgba(0, 0, 0, 0.05);
            transform: scale(1.05);
        }

        .practice-section {
            background: var(--bg-color);
            border: 2px solid var(--border-color);
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 24px;
            display: none;
        }

        .practice-section.active {
            display: block;
        }

        .practice-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 24px;
            padding-bottom: 16px;
            border-bottom: 1px solid var(--border-color);
        }

        .back-to-home {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.875rem;
        }

        .section-title {
            font-size: 1.5rem;
            font-weight: 600;
            margin: 0;
            color: var(--primary-color);
        }

        .quiz-container {
            background: var(--bg-color);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 20px;
            margin-top: 16px;
        }

        .question-text {
            font-size: 1.125rem;
            margin-bottom: 16px;
            font-weight: 500;
            color: var(--text-color);
        }

        .question-formula {
            font-size: 1.25rem;
            margin: 16px 0;
            font-weight: 500;
            padding: 16px;
            background: rgba(0, 0, 0, 0.02);
            border-radius: 8px;
            border-left: 4px solid var(--primary-color);
        }

        .options-container {
            display: grid;
            gap: 12px;
            margin: 20px 0;
        }

        .option-button {
            background: var(--bg-color);
            border: 2px solid var(--border-color);
            padding: 16px;
            border-radius: 8px;
            cursor: pointer;
            transition: var(--transition);
            text-align: left;
            font-size: 1rem;
        }

        .option-button:hover {
            border-color: var(--primary-color);
            background: rgba(0, 0, 0, 0.02);
            transform: translateX(4px);
        }

        .option-button.selected {
            border-color: var(--primary-color);
            background: rgba(0, 0, 0, 0.08);
            font-weight: 500;
        }

        .option-button.correct {
            border-color: var(--text-color);
            background: var(--bg-subtle);
            font-weight: 600;
        }

        .option-button.incorrect {
            border-color: var(--text-color);
            background: var(--bg-subtle);
            opacity: 0.6;
        }

        .quiz-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid var(--border-color);
        }

        .progress-container {
            margin: 20px 0;
            padding: 16px;
            background: rgba(0, 0, 0, 0.02);
            border-radius: 8px;
            text-align: center;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: var(--border-color);
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 12px;
        }

        .progress-fill {
            height: 100%;
            background: var(--primary-color);
            transition: width 0.3s ease;
        }

        .progress-text {
            color: var(--accent-color);
            font-size: 0.875rem;
            font-weight: 500;
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .vocabulary-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 16px;
            margin-top: 20px;
        }

        @media (min-width: 768px) {
            .vocabulary-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        .word-card {
            background: var(--bg-color);
            border: 2px solid var(--border-color);
            border-radius: 8px;
            padding: 20px;
            cursor: pointer;
            transition: var(--transition);
        }

        .word-card:hover {
            border-color: var(--primary-color);
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }

        .word-english {
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--primary-color);
        }

        .word-pronunciation {
            color: var(--accent-color);
            font-size: 0.875rem;
            font-style: italic;
            margin-bottom: 8px;
        }

        .word-japanese {
            color: var(--text-color);
            font-size: 1rem;
            margin-bottom: 12px;
        }

        .word-example {
            font-size: 0.875rem;
            color: var(--accent-color);
            font-style: italic;
            border-top: 1px solid var(--border-color);
            padding-top: 12px;
        }

        .toast {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--primary-color);
            color: var(--secondary-color);
            padding: 16px 24px;
            border-radius: 8px;
            z-index: 1001;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            max-width: 80%;
            text-align: center;
            font-size: 0.875rem;
            font-weight: 500;
            box-shadow: var(--shadow);
        }

        .toast.show {
            opacity: 1;
            visibility: visible;
            bottom: 30px;
        }

        .toast.success {
            background: #10b981;
        }

        .toast.error {
            background: #ef4444;
        }

        .material-symbols-rounded {
            font-variation-settings:
                'FILL' 0,
                'wght' 400,
                'GRAD' 0,
                'opsz' 40;
        }

        footer {
            background: var(--primary-color);
            color: var(--secondary-color);
            text-align: center;
            padding: 16px 0;
            margin-top: auto;
            font-size: 0.875rem;
        }

        .dark-mode {
            --bg-color: #0a0a0a;
            --text-color: #fff;
            --accent-color: #ccc;
            --border-color: #333;
        }

        .dark-mode .category-card,
        .dark-mode .practice-section,
        .dark-mode .quiz-container,
        .dark-mode .word-card {
            background: #111;
            border-color: #333;
        }
    </style>
</head>

<body>
    <header>
        <div class="header-content">
            <a href="../index.html" class="back-button">
                <span class="material-symbols-rounded">arrow_back</span>
            </a>
            <div class="page-title">English Quick Practice</div>
        </div>
    </header>

    <main>
        <div class="container">
            <div class="categories-grid">
                <div class="category-card" onclick="selectCategory('listening')">
                    <div class="category-icon">
                        <span class="material-symbols-rounded">headphones</span>
                    </div>
                    <h2 class="category-title">Listening</h2>
                    <p class="category-description">„É™„Çπ„Éã„É≥„Ç∞Á∑¥Áøí</p>
                    <div class="level-buttons">
                        <button class="level-btn" onclick="event.stopPropagation(); startPractice('listening', 1)">Level
                            1</button>
                        <button class="level-btn" onclick="event.stopPropagation(); startPractice('listening', 2)">Level
                            2</button>
                        <button class="level-btn" onclick="event.stopPropagation(); startPractice('listening', 3)">Level
                            3</button>
                        <button class="level-btn" onclick="event.stopPropagation(); startPractice('listening', 4)">Level
                            4</button>
                    </div>
                </div>

                <div class="category-card" onclick="selectCategory('vocabulary')">
                    <div class="category-icon">
                        <span class="material-symbols-rounded">menu_book</span>
                    </div>
                    <h2 class="category-title">Vocabulary</h2>
                    <p class="category-description">Ë™ûÂΩôÂ≠¶Áøí</p>
                    <div class="level-buttons">
                        <button class="level-btn"
                            onclick="event.stopPropagation(); startPractice('vocabulary', 1)">Level 1</button>
                        <button class="level-btn"
                            onclick="event.stopPropagation(); startPractice('vocabulary', 2)">Level 2</button>
                        <button class="level-btn"
                            onclick="event.stopPropagation(); startPractice('vocabulary', 3)">Level 3</button>
                        <button class="level-btn"
                            onclick="event.stopPropagation(); startPractice('vocabulary', 4)">Level 4</button>
                    </div>
                </div>

                <div class="category-card" onclick="selectCategory('grammar')">
                    <div class="category-icon">
                        <span class="material-symbols-rounded">edit_note</span>
                    </div>
                    <h2 class="category-title">Grammar</h2>
                    <p class="category-description">ÊñáÊ≥ïÂ≠¶Áøí</p>
                    <div class="level-buttons">
                        <button class="level-btn" onclick="event.stopPropagation(); startPractice('grammar', 1)">Level
                            1</button>
                        <button class="level-btn" onclick="event.stopPropagation(); startPractice('grammar', 2)">Level
                            2</button>
                        <button class="level-btn" onclick="event.stopPropagation(); startPractice('grammar', 3)">Level
                            3</button>
                        <button class="level-btn" onclick="event.stopPropagation(); startPractice('grammar', 4)">Level
                            4</button>
                    </div>
                </div>

                <div class="category-card" onclick="selectCategory('reading')">
                    <div class="category-icon">
                        <span class="material-symbols-rounded">auto_stories</span>
                    </div>
                    <h2 class="category-title">Reading</h2>
                    <p class="category-description">Ë™≠Ëß£Á∑¥Áøí</p>
                    <div class="level-buttons">
                        <button class="level-btn" onclick="event.stopPropagation(); startPractice('reading', 1)">Level
                            1</button>
                        <button class="level-btn" onclick="event.stopPropagation(); startPractice('reading', 2)">Level
                            2</button>
                        <button class="level-btn" onclick="event.stopPropagation(); startPractice('reading', 3)">Level
                            3</button>
                        <button class="level-btn" onclick="event.stopPropagation(); startPractice('reading', 4)">Level
                            4</button>
                    </div>
                </div>
            </div>

            <!-- Listening„Çª„ÇØ„Ç∑„Éß„É≥ -->
            <div class="practice-section" id="listeningSection">
                <div class="practice-header">
                    <button class="btn btn-secondary back-to-home" onclick="backToHome()">
                        <span class="material-symbols-rounded">arrow_back</span>
                        „Éõ„Éº„É†„Å´Êàª„Çã
                    </button>
                    <h2 class="section-title">ListeningÁ∑¥Áøí</h2>
                </div>
                <div class="quiz-container">
                    <div class="question-text">ËÅû„Åì„Åà„ÅüËã±Êñá„Å´Âêà„ÅÜÈÅ∏ÊäûËÇ¢„ÇíÈÅ∏„Çì„Åß„Åè„Å†„Åï„ÅÑÔºö</div>
                    <div class="question-formula" id="listeningQuestion">üîä „ÇØ„É™„ÉÉ„ÇØ„Åó„Å¶ÂïèÈ°å„ÇíÈñãÂßã</div>
                    <div class="options-container" id="listeningOptions"></div>
                    <div class="quiz-controls">
                        <button class="btn btn-secondary" onclick="playAudio()">üîä ÂÜçÁîü</button>
                        <button class="btn" onclick="checkAnswer()" id="listeningAnswerBtn">ÂõûÁ≠î„Åô„Çã</button>
                    </div>
                </div>
            </div>

            <!-- Vocabulary„Çª„ÇØ„Ç∑„Éß„É≥ -->
            <div class="practice-section" id="vocabularySection">
                <div class="practice-header">
                    <button class="btn btn-secondary back-to-home" onclick="backToHome()">
                        <span class="material-symbols-rounded">arrow_back</span>
                        „Éõ„Éº„É†„Å´Êàª„Çã
                    </button>
                    <h2 class="section-title">Ë™ûÂΩôÂ≠¶Áøí</h2>
                </div>
                <div class="vocabulary-grid" id="vocabularyGrid"></div>
            </div>

            <!-- Grammar„Çª„ÇØ„Ç∑„Éß„É≥ -->
            <div class="practice-section" id="grammarSection">
                <div class="practice-header">
                    <button class="btn btn-secondary back-to-home" onclick="backToHome()">
                        <span class="material-symbols-rounded">arrow_back</span>
                        „Éõ„Éº„É†„Å´Êàª„Çã
                    </button>
                    <h2 class="section-title">ÊñáÊ≥ï„ÇØ„Ç§„Ç∫</h2>
                </div>
                <div class="quiz-container">
                    <div class="question-text">Ê¨°„ÅÆÊñá„ÅÆÁ©∫ÊâÄ„Å´ÈÅ©Âàá„Å™ÂçòË™û„ÇíÈÅ∏„Çì„Åß„Åè„Å†„Åï„ÅÑÔºö</div>
                    <div class="question-formula" id="grammarQuestion">„ÇØ„É™„ÉÉ„ÇØ„Åó„Å¶ÂïèÈ°å„ÇíÈñãÂßã</div>
                    <div class="options-container" id="grammarOptions"></div>
                    <div class="quiz-controls">
                        <button class="btn btn-secondary" onclick="skipQuestion()">„Çπ„Ç≠„ÉÉ„Éó</button>
                        <button class="btn" onclick="checkAnswer()" id="grammarAnswerBtn">ÂõûÁ≠î„Åô„Çã</button>
                    </div>
                </div>
            </div>

            <!-- Reading„Çª„ÇØ„Ç∑„Éß„É≥ -->
            <div class="practice-section" id="readingSection">
                <div class="practice-header">
                    <button class="btn btn-secondary back-to-home" onclick="backToHome()">
                        <span class="material-symbols-rounded">arrow_back</span>
                        „Éõ„Éº„É†„Å´Êàª„Çã
                    </button>
                    <h2 class="section-title">Ë™≠Ëß£Á∑¥Áøí</h2>
                </div>
                <div class="quiz-container">
                    <div class="question-text">Ê¨°„ÅÆÊñáÁ´†„ÇíË™≠„Çì„ÅßË≥™Âïè„Å´Á≠î„Åà„Å¶„Åè„Å†„Åï„ÅÑÔºö</div>
                    <div class="question-formula" id="readingPassage">„ÇØ„É™„ÉÉ„ÇØ„Åó„Å¶ÂïèÈ°å„ÇíÈñãÂßã</div>
                    <div class="question-text" id="readingQuestion"></div>
                    <div class="options-container" id="readingOptions"></div>
                    <div class="quiz-controls">
                        <button class="btn" onclick="checkAnswer()" id="readingAnswerBtn">ÂõûÁ≠î„Åô„Çã</button>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <footer>
        <div class="container">
            <p>&copy; 2024 „Åú„Çç</p>
        </div>
    </footer>

    <div class="toast" id="toast"></div>

    <script>
        // Â≠¶Áøí„Ç≥„É≥„ÉÜ„É≥„ÉÑ
        const learningContent = {
            listening: {
                1: [
                    { id: 1, question: "ËÅû„Åì„Åà„ÅüËã±Êñá„Å´Âêà„ÅÜÈÅ∏ÊäûËÇ¢„ÇíÈÅ∏„Çì„Åß„Åè„Å†„Åï„ÅÑÔºö", audio: "I study English every day.", options: ["I study English every day.", "I studied English yesterday.", "I will study English tomorrow."], correct: "A" },
                    { id: 2, question: "ËÅû„Åì„Åà„ÅüËã±Êñá„Å´Âêà„ÅÜÈÅ∏ÊäûËÇ¢„ÇíÈÅ∏„Çì„Åß„Åè„Å†„Åï„ÅÑÔºö", audio: "My name is Sarah.", options: ["My name is Sarah.", "His name is Sarah.", "Her name is Sarah."], correct: "A" },
                    { id: 3, question: "ËÅû„Åì„Åà„ÅüËã±Êñá„Å´Âêà„ÅÜÈÅ∏ÊäûËÇ¢„ÇíÈÅ∏„Çì„Åß„Åè„Å†„Åï„ÅÑÔºö", audio: "The weather is nice today.", options: ["The weather is nice today.", "The weather was nice yesterday.", "The weather will be nice tomorrow."], correct: "A" },
                    { id: 4, question: "ËÅû„Åì„Åà„ÅüËã±Êñá„Å´Âêà„ÅÜÈÅ∏ÊäûËÇ¢„ÇíÈÅ∏„Çì„Åß„Åè„Å†„Åï„ÅÑÔºö", audio: "I like coffee very much.", options: ["I like coffee very much.", "I liked coffee very much.", "I will like coffee very much."], correct: "A" },
                    { id: 5, question: "ËÅû„Åì„Åà„ÅüËã±Êñá„Å´Âêà„ÅÜÈÅ∏ÊäûËÇ¢„ÇíÈÅ∏„Çì„Åß„Åè„Å†„Åï„ÅÑÔºö", audio: "She goes to school by bus.", options: ["She go to school by bus.", "She goes to school by bus.", "She going to school by bus."], correct: "B" }
                ],
                2: [
                    { id: 1, question: "ËÅû„Åì„Åà„ÅüËã±Êñá„Å´Âêà„ÅÜÈÅ∏ÊäûËÇ¢„ÇíÈÅ∏„Çì„Åß„Åè„Å†„Åï„ÅÑÔºö", audio: "She has been working here for three years.", options: ["She works here.", "She worked here.", "She has been working here for three years."], correct: "C" },
                    { id: 2, question: "ËÅû„Åì„Åà„ÅüËã±Êñá„Å´Âêà„ÅÜÈÅ∏ÊäûËÇ¢„ÇíÈÅ∏„Çì„Åß„Åè„Å†„Åï„ÅÑÔºö", audio: "If I had known, I would have helped.", options: ["If I know, I will help.", "If I knew, I would help.", "If I had known, I would have helped."], correct: "C" },
                    { id: 3, question: "ËÅû„Åì„Åà„ÅüËã±Êñá„Å´Âêà„ÅÜÈÅ∏ÊäûËÇ¢„ÇíÈÅ∏„Çì„Åß„Åè„Å†„Åï„ÅÑÔºö", audio: "The book was written by a famous author.", options: ["The book is written by a famous author.", "The book was written by a famous author.", "The book will be written by a famous author."], correct: "B" }
                ]
            },
            vocabulary: {
                1: [
                    { id: 1, word: "perspective", pronunciation: "[p…ôrÀàspekt…™v]", meaning: "Ë¶ñÁÇπ„ÄÅË¶≥ÁÇπ", example: "From my perspective, this is the best solution." },
                    { id: 2, word: "inevitable", pronunciation: "[…™nÀàev…™t…ôbl]", meaning: "ÈÅø„Åë„Çâ„Çå„Å™„ÅÑ", example: "Change is inevitable in life." },
                    { id: 3, word: "collaborate", pronunciation: "[k…ôÀàl√¶b…ôre…™t]", meaning: "ÂçîÂäõ„Åô„Çã", example: "We need to collaborate on this project." },
                    { id: 4, word: "resilient", pronunciation: "[r…™Ààz…™li…ônt]", meaning: "ÂõûÂæ©Âäõ„ÅÆ„ÅÇ„Çã", example: "Children are often more resilient than adults." },
                    { id: 5, word: "significant", pronunciation: "[s…™…°Ààn…™f…™k…ônt]", meaning: "ÈáçË¶Å„Å™", example: "This is a significant moment in history." }
                ],
                2: [
                    { id: 1, word: "sophisticated", pronunciation: "[s…ôÀàf…™st…™ke…™t…™d]", meaning: "Ê¥óÁ∑¥„Åï„Çå„Åü", example: "She has a sophisticated taste in art." },
                    { id: 2, word: "ambiguous", pronunciation: "[√¶mÀàb…™…°ju…ôs]", meaning: "„ÅÇ„ÅÑ„Åæ„ÅÑ„Å™", example: "The instructions were ambiguous." },
                    { id: 3, word: "comprehensive", pronunciation: "[Àåk…ëÀêmpr…™Ààhens…™v]", meaning: "ÂåÖÊã¨ÁöÑ„Å™", example: "We need a comprehensive review of the policy." }
                ]
            },
            grammar: {
                1: [
                    { id: 1, question: "Ê¨°„ÅÆÊñá„ÅÆÁ©∫ÊâÄ„Å´ÈÅ©Âàá„Å™ÂçòË™û„ÇíÈÅ∏„Çì„Åß„Åè„Å†„Åï„ÅÑÔºö", sentence: "I ___ to the park every morning.", options: ["go", "goes", "going", "went"], correct: "A", explanation: "ÁèæÂú®ÂΩ¢„ÅØ„ÄåI + ÂãïË©û„ÅÆÂéüÂΩ¢„Äç„Å´„Å™„Çä„Åæ„Åô„ÄÇ" },
                    { id: 2, question: "Ê¨°„ÅÆÊñá„ÅÆÁ©∫ÊâÄ„Å´ÈÅ©Âàá„Å™ÂçòË™û„ÇíÈÅ∏„Çì„Åß„Åè„Å†„Åï„ÅÑÔºö", sentence: "She ___ English very well.", options: ["speak", "speaks", "speaking", "spoke"], correct: "B", explanation: "‰∏â‰∫∫Áß∞ÂçòÊï∞ÁèæÂú®ÂΩ¢„ÅØ„Äå‰∏ªË™û + ÂãïË©û-s„Äç„Å´„Å™„Çä„Åæ„Åô„ÄÇ" },
                    { id: 3, question: "Ê¨°„ÅÆÊñá„ÅÆÁ©∫ÊâÄ„Å´ÈÅ©Âàá„Å™ÂçòË™û„ÇíÈÅ∏„Çì„Åß„Åè„Å†„Åï„ÅÑÔºö", sentence: "They ___ to school yesterday.", options: ["go", "goes", "going", "went"], correct: "D", explanation: "ÈÅéÂéªÂΩ¢„ÅØ„ÄåÂãïË©û-ed„Äç„Åæ„Åü„ÅØ‰∏çË¶èÂâáÂãïË©û„ÅÆÈÅéÂéªÂΩ¢„Å´„Å™„Çä„Åæ„Åô„ÄÇ" },
                    { id: 4, question: "Ê¨°„ÅÆÊñá„ÅÆÁ©∫ÊâÄ„Å´ÈÅ©Âàá„Å™ÂçòË™û„ÇíÈÅ∏„Çì„Åß„Åè„Å†„Åï„ÅÑÔºö", sentence: "I ___ my homework now.", options: ["do", "am doing", "did", "have done"], correct: "B", explanation: "ÁèæÂú®ÈÄ≤Ë°åÂΩ¢„ÅØ„Äåbe + ÂãïË©û-ing„Äç„Å´„Å™„Çä„Åæ„Åô„ÄÇ" },
                    { id: 5, question: "Ê¨°„ÅÆÊñá„ÅÆÁ©∫ÊâÄ„Å´ÈÅ©Âàá„Å™ÂçòË™û„ÇíÈÅ∏„Çì„Åß„Åè„Å†„Åï„ÅÑÔºö", sentence: "We ___ to Japan last year.", options: ["go", "went", "have gone", "will go"], correct: "B", explanation: "ÈÅéÂéª„ÇíÁ§∫„Åô„Äålast year„Äç„Åå„ÅÇ„Çã„ÅÆ„ÅßÈÅéÂéªÂΩ¢„Çí‰Ωø„ÅÑ„Åæ„Åô„ÄÇ" }
                ]
            },
            reading: {
                1: [
                    {
                        id: 1,
                        passage: "Tom is a 16-year-old high school student. He lives in Tokyo with his parents and younger sister. Every morning, he wakes up at 6:30 AM and takes the train to school. His favorite subject is mathematics, and he dreams of becoming an engineer. After school, he usually participates in the basketball club and returns home around 6 PM.",
                        question: "What time does Tom usually return home?",
                        options: ["5 PM", "6 PM", "7 PM", "8 PM"],
                        correct: "B"
                    },
                    {
                        id: 2,
                        passage: "Sarah works as a nurse at a local hospital. She has been working there for five years and loves helping patients. Her shift starts at 7 AM and ends at 3 PM. During her break, she enjoys reading medical journals to stay updated with the latest treatments. In her free time, she likes hiking and photography.",
                        question: "How long has Sarah been working at the hospital?",
                        options: ["Three years", "Four years", "Five years", "Six years"],
                        correct: "C"
                    }
                ]
            }
        };

        // Áä∂ÊÖãÂ§âÊï∞
        let currentCategory = null;
        let currentLevel = 1;
        let currentQuestionIndex = 0;
        let score = 0;
        let totalAnswered = 0;
        let selectedOption = null;
        let currentQuestions = [];

        // „Ç´„ÉÜ„Ç¥„É™„ÉºÈÅ∏Êäû
        function selectCategory(category) {
            showToast(`${getCategoryName(category)}„ÇíÈÅ∏Êäû„Åó„Åæ„Åó„Åü„ÄÇ„É¨„Éô„É´„ÇíÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ`, 'success');
        }

        // Á∑¥ÁøíÈñãÂßã
        function startPractice(category, level) {
            currentCategory = category;
            currentLevel = level;
            currentQuestionIndex = 0;
            score = 0;
            totalAnswered = 0;
            selectedOption = null;

            // „Ç´„ÉÜ„Ç¥„É™„Éº„Ç∞„É™„ÉÉ„Éâ„ÇíÈùûË°®Á§∫
            document.querySelector('.categories-grid').style.display = 'none';

            // ÈÅ∏Êäû„Åï„Çå„Åü„Çª„ÇØ„Ç∑„Éß„É≥„ÇíË°®Á§∫
            const section = document.getElementById(`${category}Section`);
            section.classList.add('active');
            section.style.display = 'block';

            if (category === 'vocabulary') {
                loadVocabulary();
            } else {
                loadQuizQuestion();
            }

            showToast(`${getCategoryName(category)} Level ${level}„ÇíÈñãÂßã„Åó„Åæ„ÅôÔºÅ`, 'success');
        }

        // Ë™ûÂΩôË™≠„ÅøËæº„Åø
        function loadVocabulary() {
            const questions = learningContent[currentCategory][currentLevel] || [];
            const grid = document.getElementById('vocabularyGrid');
            grid.innerHTML = '';

            questions.forEach(item => {
                const card = document.createElement('div');
                card.className = 'word-card';
                card.innerHTML = `
                    <div class="word-english">${item.word}</div>
                    <div class="word-pronunciation">${item.pronunciation}</div>
                    <div class="word-japanese">${item.meaning}</div>
                    <div class="word-example">‰æã: ${item.example}</div>
                `;
                grid.appendChild(card);
            });
        }

        // „ÇØ„Ç§„Ç∫ÂïèÈ°åË™≠„ÅøËæº„Åø
        function loadQuizQuestion() {
            currentQuestions = learningContent[currentCategory][currentLevel] || [];

            if (currentQuestions.length === 0) {
                showToast('„Åì„ÅÆ„É¨„Éô„É´„ÅÆÂïèÈ°å„ÅØ„Åæ„Å†„ÅÇ„Çä„Åæ„Åõ„Çì', 'error');
                return;
            }

            if (currentQuestionIndex >= currentQuestions.length) {
                showSessionComplete();
                return;
            }

            const question = currentQuestions[currentQuestionIndex];
            displayQuestion(question);
            updateProgress();
        }

        // ÂïèÈ°åË°®Á§∫
        function displayQuestion(question) {
            if (currentCategory === 'listening') {
                document.getElementById('listeningQuestion').innerHTML = `üîä "${question.audio}"`;
                displayOptions('listeningOptions', question.options);
            } else if (currentCategory === 'grammar') {
                document.getElementById('grammarQuestion').textContent = `"${question.sentence}"`;
                displayOptions('grammarOptions', question.options);
            } else if (currentCategory === 'reading') {
                document.getElementById('readingPassage').textContent = `"${question.passage}"`;
                document.getElementById('readingQuestion').textContent = question.question;
                displayOptions('readingOptions', question.options);
            }
        }

        // ÈÅ∏ÊäûËÇ¢Ë°®Á§∫
        function displayOptions(containerId, options) {
            const container = document.getElementById(containerId);
            container.innerHTML = '';

            options.forEach((option, index) => {
                const button = document.createElement('button');
                button.className = 'option-button';
                button.textContent = `${String.fromCharCode(65 + index)}) ${option}`;
                button.onclick = () => selectOption(button, String.fromCharCode(65 + index));
                container.appendChild(button);
            });
        }

        // ÈÅ∏ÊäûËÇ¢ÈÅ∏Êäû
        function selectOption(button, option) {
            // „Åô„Åπ„Å¶„ÅÆÈÅ∏ÊäûËÇ¢„ÅÆÈÅ∏ÊäûÁä∂ÊÖã„Çí„É™„Çª„ÉÉ„Éà
            document.querySelectorAll('.option-button').forEach(btn => {
                btn.classList.remove('selected');
            });

            button.classList.add('selected');
            selectedOption = option;
        }

        // ÂõûÁ≠î„ÉÅ„Çß„ÉÉ„ÇØ
        function checkAnswer() {
            if (!selectedOption) {
                showToast('ÂõûÁ≠î„ÇíÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ', 'error');
                return;
            }

            const question = currentQuestions[currentQuestionIndex];
            const isCorrect = selectedOption === question.correct;

            totalAnswered++;

            if (isCorrect) {
                score++;
                showToast('Ê≠£Ëß£„Åß„ÅôÔºÅ', 'success');

                // Ê≠£Ëß£„ÅÆÈÅ∏ÊäûËÇ¢„ÇíÁ∑ëËâ≤„Å´
                document.querySelectorAll('.option-button').forEach(btn => {
                    if (btn.textContent.startsWith(selectedOption)) {
                        btn.classList.add('correct');
                    }
                });

                // ÊñáÊ≥ïÂïèÈ°å„ÅÆÂ†¥Âêà„ÅØËß£Ë™¨„ÇíË°®Á§∫
                if (currentCategory === 'grammar' && question.explanation) {
                    setTimeout(() => {
                        showToast(`Ëß£Ë™¨: ${question.explanation}`, 'success');
                    }, 1500);
                }
            } else {
                showToast(`‰∏çÊ≠£Ëß£„Åß„Åô„ÄÇÊ≠£Ëß£„ÅØ ${question.correct}) ${question.options[question.correct.charCodeAt(0) - 65]}`, 'error');

                // Ê≠£Ëß£„Å®‰∏çÊ≠£Ëß£„ÅÆÈÅ∏ÊäûËÇ¢„ÇíËâ≤‰ªò„Åë
                document.querySelectorAll('.option-button').forEach(btn => {
                    if (btn.textContent.startsWith(selectedOption)) {
                        btn.classList.add('incorrect');
                    }
                    if (btn.textContent.startsWith(question.correct)) {
                        btn.classList.add('correct');
                    }
                });

                // ÊñáÊ≥ïÂïèÈ°å„ÅÆÂ†¥Âêà„ÅØËß£Ë™¨„ÇíË°®Á§∫
                if (currentCategory === 'grammar' && question.explanation) {
                    setTimeout(() => {
                        showToast(`Ëß£Ë™¨: ${question.explanation}`, 'error');
                    }, 2000);
                }
            }

            // ÂõûÁ≠î„Éú„Çø„É≥„ÇíÁÑ°ÂäπÂåñ
            const answerBtn = document.getElementById(`${currentCategory}AnswerBtn`);
            if (answerBtn) {
                answerBtn.disabled = true;
            }

            // 3ÁßíÂæå„Å´Ê¨°„ÅÆÂïèÈ°å„Å∏
            setTimeout(() => {
                nextQuestion();
            }, 3000);
        }

        // Ê¨°„ÅÆÂïèÈ°å„Å∏
        function nextQuestion() {
            selectedOption = null;
            currentQuestionIndex++;

            if (currentQuestionIndex < currentQuestions.length) {
                loadQuizQuestion();
            } else {
                showSessionComplete();
            }
        }

        // „Çπ„Ç≠„ÉÉ„Éó
        function skipQuestion() {
            showToast('ÂïèÈ°å„Çí„Çπ„Ç≠„ÉÉ„Éó„Åó„Åæ„Åó„Åü', 'info');
            nextQuestion();
        }

        // ÈÄ≤ÊçóÊõ¥Êñ∞
        function updateProgress() {
            const progress = ((currentQuestionIndex + 1) / currentQuestions.length) * 100;
            const accuracy = totalAnswered > 0 ? Math.round((score / totalAnswered) * 100) : 0;

            // „Éó„É≠„Ç∞„É¨„Çπ„Éê„Éº„Çí‰ΩúÊàê„Åæ„Åü„ÅØÊõ¥Êñ∞
            let progressContainer = document.querySelector('.progress-container');
            if (!progressContainer) {
                progressContainer = document.createElement('div');
                progressContainer.className = 'progress-container';

                const activeSection = document.querySelector('.practice-section.active .quiz-container');
                if (activeSection) {
                    activeSection.insertBefore(progressContainer, activeSection.firstChild);
                }
            }

            progressContainer.innerHTML = `
                <div class="progress-bar">
                    <div class="progress-fill" style="width: ${progress}%"></div>
                </div>
                <div class="progress-text">
                    ÂïèÈ°å ${currentQuestionIndex + 1} / ${currentQuestions.length} | Ê≠£Ëß£Áéá: ${accuracy}%
                </div>
            `;
        }

        // „Çª„ÉÉ„Ç∑„Éß„É≥ÂÆå‰∫Ü
        function showSessionComplete() {
            const accuracy = Math.round((score / totalAnswered) * 100);
            let message = `„Çª„ÉÉ„Ç∑„Éß„É≥ÂÆå‰∫ÜÔºÅ\nÊ≠£Ëß£Áéá: ${accuracy}% (${score}/${totalAnswered})`;

            if (accuracy >= 80) {
                message += '\nÁ¥†Êô¥„Çâ„Åó„ÅÑÁµêÊûú„Åß„ÅôÔºÅ';
            } else if (accuracy >= 60) {
                message += '\nËâØ„ÅÑË™øÂ≠ê„Åß„ÅôÔºÅÁ∂ö„Åë„Åæ„Åó„Çá„ÅÜÔºÅ';
            } else {
                message += '\n„ÇÇ„ÅÜ‰∏ÄÂ∫¶Âæ©Áøí„Åó„Åæ„Åó„Çá„ÅÜÔºÅ';
            }

            showToast(message, 'success');

            // 5ÁßíÂæå„Å´„Éõ„Éº„É†„Å´Êàª„Çã
            setTimeout(() => {
                backToHome();
            }, 5000);
        }

        // Èü≥Â£∞ÂÜçÁîü
        function playAudio() {
            if (currentQuestions.length === 0) return;

            const question = currentQuestions[currentQuestionIndex];
            const textToSpeak = question.audio || '';

            if ('speechSynthesis' in window) {
                window.speechSynthesis.cancel();
                const utterance = new SpeechSynthesisUtterance(textToSpeak);
                utterance.lang = 'en-US';
                utterance.rate = 0.9;
                utterance.pitch = 1;

                utterance.onstart = () => {
                    showToast('Èü≥Â£∞„ÇíÂÜçÁîü‰∏≠...', 'success');
                };

                utterance.onend = () => {
                    showToast('Èü≥Â£∞ÂÜçÁîüÂÆå‰∫Ü', 'success');
                };

                utterance.onerror = () => {
                    showToast('Èü≥Â£∞ÂÜçÁîü„Ç®„É©„Éº', 'error');
                };

                window.speechSynthesis.speak(utterance);
            } else {
                showToast('Èü≥Â£∞ÂÜçÁîü: ' + textToSpeak, 'success');
            }
        }

        // „Éõ„Éº„É†„Å´Êàª„Çã
        function backToHome() {
            // „Åô„Åπ„Å¶„ÅÆÁ∑¥Áøí„Çª„ÇØ„Ç∑„Éß„É≥„ÇíÈùûË°®Á§∫
            document.querySelectorAll('.practice-section').forEach(section => {
                section.classList.remove('active');
                section.style.display = 'none';
            });

            // „Ç´„ÉÜ„Ç¥„É™„Éº„Ç∞„É™„ÉÉ„Éâ„ÇíË°®Á§∫
            document.querySelector('.categories-grid').style.display = 'grid';

            // Áä∂ÊÖã„Çí„É™„Çª„ÉÉ„Éà
            currentCategory = null;
            currentLevel = 1;
            currentQuestionIndex = 0;
            score = 0;
            totalAnswered = 0;
            selectedOption = null;
            currentQuestions = [];

            showToast('„Éõ„Éº„É†„Å´Êàª„Çä„Åæ„Åó„Åü', 'success');
        }

        // „Éà„Éº„Çπ„ÉàË°®Á§∫
        function showToast(message, type = 'info') {
            const toast = document.getElementById('toast');
            toast.textContent = message;
            toast.className = `toast ${type}`;

            setTimeout(() => {
                toast.classList.add('show');
            }, 100);

            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }

        // „Ç´„ÉÜ„Ç¥„É™„ÉºÂêçÂèñÂæó
        function getCategoryName(category) {
            const names = {
                'listening': 'Listening',
                'vocabulary': 'Vocabulary',
                'grammar': 'Grammar',
                'reading': 'Reading'
            };
            return names[category] || category;
        }

        // ÂàùÊúüÂåñ
        document.addEventListener('DOMContentLoaded', () => {
            showToast('„Çà„ÅÜ„Åì„ÅùÔºÅÂ≠¶Áøí„Åó„Åü„ÅÑ„Ç´„ÉÜ„Ç¥„É™„Éº„Å®„É¨„Éô„É´„ÇíÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ', 'success');
        });
    </script>
</body>

</html>