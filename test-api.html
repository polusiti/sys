<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API Client Test</title>
    <style>
        body { font-family: sans-serif; padding: 2rem; }
        .result { background: #f5f5f5; padding: 1rem; margin: 1rem 0; border-radius: 4px; }
        .error { background: #ffebee; color: #c62828; }
        .success { background: #e8f5e8; color: #2e7d32; }
        button { padding: 0.5rem 1rem; margin: 0.5rem; cursor: pointer; }
    </style>
</head>
<body>
    <h1>統一APIクライアントテスト</h1>
    <div id="results"></div>

    <button onclick="testAPIClient()">APIクライアントテスト</button>
    <button onclick="testHealthCheck()">ヘルスチェック</button>

    <script type="module">
        import { apiClient } from './js/core/unified-api-client.js';

        window.testAPIClient = function() {
            const results = document.getElementById('results');

            try {
                const result = {
                    apiBaseUrl: apiClient.apiBaseUrl,
                    adminToken: apiClient.adminToken ? '設定済み' : '未設定',
                    endpoints: Object.keys(apiClient.endpoints),
                    methods: Object.getOwnPropertyNames(Object.getPrototypeOf(apiClient))
                        .filter(name => typeof apiClient[name] === 'function')
                };

                results.innerHTML = `
                    <div class="result success">
                        <h3>✅ APIクライアント初期化成功</h3>
                        <pre>${JSON.stringify(result, null, 2)}</pre>
                    </div>
                `;
            } catch (error) {
                results.innerHTML = `
                    <div class="result error">
                        <h3>❌ APIクライアント初期化失敗</h3>
                        <p>${error.message}</p>
                    </div>
                `;
            }
        };

        window.testHealthCheck = async function() {
            const results = document.getElementById('results');

            try {
                const health = await apiClient.healthCheck();
                results.innerHTML = `
                    <div class="result success">
                        <h3>✅ ヘルスチェック成功</h3>
                        <pre>${JSON.stringify(health, null, 2)}</pre>
                    </div>
                `;
            } catch (error) {
                results.innerHTML = `
                    <div class="result error">
                        <h3>❌ ヘルスチェック失敗</h3>
                        <p>${error.message}</p>
                    </div>
                `;
            }
        };

        // Auto-run on load
        window.addEventListener('load', () => {
            console.log('Testing API client initialization...');
            testAPIClient();
        });
    </script>
</body>
</html>