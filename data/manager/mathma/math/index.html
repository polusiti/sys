<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ“ æ•°å­¦å•é¡Œ - ã‚·ãƒ³ãƒ—ãƒ«çµ±ä¸€ç®¡ç†</title>
    <style>
        :root {
            --primary-color: #3b82f6;
            --secondary-color: #1e40af;
            --accent-color: #60a5fa;
            --bg-color: #eff6ff;
            --text-color: #1f2937;
            --border-color: #bfdbfe;
            --hover-bg: #dbeafe;
            --success-color: #10b981;
            --warning-color: #f59e0b;
            --error-color: #ef4444;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Hiragino Sans', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: white;
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            text-align: center;
        }

        .header h1 {
            font-size: 2.5rem;
            color: var(--primary-color);
            margin-bottom: 10px;
        }

        .header p {
            color: #6b7280;
            font-size: 1.1rem;
        }

        .nav-breadcrumb {
            background: white;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        .nav-breadcrumb a {
            color: var(--primary-color);
            text-decoration: none;
            margin-right: 10px;
        }

        .nav-breadcrumb a:hover {
            text-decoration: underline;
        }

        .controls-section {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }

        .controls-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .control-group {
            display: flex;
            flex-direction: column;
        }

        .control-group label {
            font-weight: 600;
            margin-bottom: 5px;
            color: var(--text-color);
        }

        .control-group select,
        .control-group input {
            padding: 10px;
            border: 2px solid var(--border-color);
            border-radius: 6px;
            font-size: 1rem;
            transition: border-color 0.3s;
        }

        .control-group select:focus,
        .control-group input:focus {
            outline: none;
            border-color: var(--primary-color);
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
            text-align: center;
        }

        .btn-primary {
            background: var(--primary-color);
            color: white;
        }

        .btn-primary:hover {
            background: var(--secondary-color);
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: #6b7280;
            color: white;
        }

        .btn-secondary:hover {
            background: #4b5563;
        }

        .btn-success {
            background: var(--success-color);
            color: white;
        }

        .btn-warning {
            background: var(--warning-color);
            color: white;
        }

        .btn-error {
            background: var(--error-color);
            color: white;
        }

        .questions-section {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }

        .questions-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--border-color);
        }

        .questions-list {
            min-height: 300px;
        }

        .question-card {
            border: 2px solid var(--border-color);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 15px;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .question-card:hover {
            border-color: var(--primary-color);
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .question-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .question-meta {
            display: flex;
            gap: 15px;
            font-size: 0.9rem;
            color: #6b7280;
        }

        .question-title {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 10px;
        }

        .question-content {
            font-size: 1rem;
            margin-bottom: 15px;
            line-height: 1.6;
        }

        .question-tags {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .tag {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .tag-type {
            background: var(--primary-color);
            color: white;
        }

        .tag-difficulty {
            background: var(--success-color);
            color: white;
        }

        .tag-difficulty.medium {
            background: var(--warning-color);
        }

        .tag-difficulty.hard {
            background: var(--error-color);
        }

        .tag-category {
            background: #8b5cf6;
            color: white;
        }

        .tag-approval {
            background: #10b981;
            color: white;
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #6b7280;
        }

        .empty-state-icon {
            font-size: 4rem;
            margin-bottom: 20px;
        }

        .stats-bar {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
            text-align: center;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 20px;
            margin-top: 15px;
        }

        .stat-item h3 {
            font-size: 2rem;
            margin-bottom: 5px;
        }

        .stat-item p {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }
            
            .controls-grid {
                grid-template-columns: 1fr;
            }
            
            .questions-header {
                flex-direction: column;
                align-items: stretch;
                gap: 15px;
            }
            
            .question-header {
                flex-direction: column;
                align-items: stretch;
                gap: 10px;
            }
            
            .question-meta {
                flex-wrap: wrap;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="nav-breadcrumb">
            <a href="../">ğŸ”¢ Math Manager</a> â†’ <span>ğŸ“ æ•°å­¦å•é¡Œ</span>
        </div>

        <div class="header">
            <h1>ğŸ“ æ•°å­¦å•é¡Œ</h1>
            <p>ã™ã¹ã¦ã®æ•°å­¦å•é¡Œã‚’çµ±ä¸€ç®¡ç†ã™ã‚‹å˜ä¸€ã‚·ã‚¹ãƒ†ãƒ </p>
        </div>

        <div class="stats-bar">
            <h3>çµ±ä¸€æ•°å­¦å•é¡Œã‚·ã‚¹ãƒ†ãƒ </h3>
            <div class="stats-grid">
                <div class="stat-item">
                    <h3 id="totalQuestions">0</h3>
                    <p>ç·å•é¡Œæ•°</p>
                </div>
                <div class="stat-item">
                    <h3 id="approvedQuestions">0</h3>
                    <p>æ‰¿èªæ¸ˆã¿</p>
                </div>
                <div class="stat-item">
                    <h3 id="categoriesCount">0</h3>
                    <p>ã‚«ãƒ†ã‚´ãƒª</p>
                </div>
                <div class="stat-item">
                    <h3 id="averageRating">0.0</h3>
                    <p>å¹³å‡è©•ä¾¡</p>
                </div>
            </div>
        </div>

        <div class="controls-section">
            <div class="controls-grid">
                <div class="control-group">
                    <label for="filterType">å•é¡Œå½¢å¼</label>
                    <select id="filterType">
                        <option value="">ã™ã¹ã¦</option>
                        <option value="A1">A1æŠ (é¸æŠå¼)</option>
                        <option value="F1">F1è‡ªç”± (çŸ­ç­”å¼)</option>
                        <option value="F2">F2è¨˜è¿° (è¨˜è¿°å¼)</option>
                    </select>
                </div>
                <div class="control-group">
                    <label for="filterDifficulty">é›£æ˜“åº¦</label>
                    <select id="filterDifficulty">
                        <option value="">ã™ã¹ã¦</option>
                        <option value="æ˜“">æ˜“ (åŸºç¤)</option>
                        <option value="ä¸­">ä¸­ (æ¨™æº–)</option>
                        <option value="é›£">é›£ (ç™ºå±•)</option>
                    </select>
                </div>
                <div class="control-group">
                    <label for="filterCategory">ã‚«ãƒ†ã‚´ãƒª</label>
                    <select id="filterCategory">
                        <option value="">ã™ã¹ã¦</option>
                    </select>
                </div>
                <div class="control-group">
                    <label for="searchText">æ¤œç´¢</label>
                    <input type="text" id="searchText" placeholder="ã‚¿ã‚¤ãƒˆãƒ«ãƒ»å•é¡Œæ–‡ã§æ¤œç´¢">
                </div>
            </div>
            <div style="display: flex; gap: 10px; flex-wrap: wrap; margin-top: 15px;">
                <button class="btn btn-primary" onclick="applyFilters()">ğŸ” æ¤œç´¢ãƒ»ãƒ•ã‚£ãƒ«ã‚¿é©ç”¨</button>
                <button class="btn btn-secondary" onclick="clearFilters()">ğŸ—‘ï¸ ãƒ•ã‚£ãƒ«ã‚¿ã‚¯ãƒªã‚¢</button>
                <button class="btn btn-success" onclick="refreshQuestions()">ğŸ”„ æ›´æ–°</button>
            </div>
        </div>

        <div class="questions-section">
            <div class="questions-header">
                <h2>å•é¡Œä¸€è¦§</h2>
                <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                    <button class="btn btn-primary" onclick="window.location.href='../creator/'">âœ¨ æ–°è¦ä½œæˆ</button>
                    <button class="btn btn-warning" onclick="sortQuestions()">ğŸ“Š ä¸¦ã³æ›¿ãˆ</button>
                </div>
            </div>
            <div class="questions-list" id="questionsList">
                <div class="empty-state">
                    <div class="empty-state-icon">ğŸ“</div>
                    <h3>ã¾ã å•é¡ŒãŒã‚ã‚Šã¾ã›ã‚“</h3>
                    <p>ã€Œâœ¨ æ–°è¦ä½œæˆã€ã¾ãŸã¯ã€ŒğŸ“¥ ã‚µãƒ³ãƒ—ãƒ«èª­ã¿è¾¼ã¿ã€ã§å•é¡Œã‚’è¿½åŠ ã—ã¦ãã ã•ã„</p>
                    <button class="btn btn-primary" onclick="loadSampleData()" style="margin-top: 20px;">ğŸ“¥ ã‚µãƒ³ãƒ—ãƒ«å•é¡Œèª­ã¿è¾¼ã¿</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // çµ±ä¸€æ•°å­¦å•é¡Œç®¡ç†ã‚·ã‚¹ãƒ†ãƒ 
        class UnifiedMathSystem {
            constructor() {
                this.questions = [];
                this.filteredQuestions = [];
                this.sortBy = 'created';
                this.sortOrder = 'desc';
                this.init();
            }

            init() {
                this.loadQuestions();
                this.setupEventListeners();
                this.populateCategoryFilter();
                this.updateStats();
                this.renderQuestions();
            }

            setupEventListeners() {
                // ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ¤œç´¢
                document.getElementById('searchText').addEventListener('input', () => {
                    this.applyFilters();
                });

                // ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼å¤‰æ›´æ™‚ã®è‡ªå‹•é©ç”¨
                ['filterType', 'filterDifficulty', 'filterCategory'].forEach(id => {
                    document.getElementById(id).addEventListener('change', () => {
                        this.applyFilters();
                    });
                });
            }

            loadQuestions() {
                this.questions = JSON.parse(localStorage.getItem('mathQuestions') || '[]');
                this.filteredQuestions = [...this.questions];
            }

            populateCategoryFilter() {
                const categories = [...new Set(this.questions.map(q => q.category).filter(Boolean))];
                const categorySelect = document.getElementById('filterCategory');
                
                // æ—¢å­˜ã‚ªãƒ—ã‚·ãƒ§ãƒ³ä»¥å¤–ã‚’ã‚¯ãƒªã‚¢
                categorySelect.innerHTML = '<option value="">ã™ã¹ã¦</option>';
                
                categories.forEach(category => {
                    const option = document.createElement('option');
                    option.value = category;
                    option.textContent = category;
                    categorySelect.appendChild(option);
                });
            }

            updateStats() {
                const total = this.questions.length;
                const approved = this.questions.filter(q => q.approvals >= 3).length;
                const categories = [...new Set(this.questions.map(q => q.category).filter(Boolean))].length;
                const avgRating = total > 0 ? 
                    (this.questions.reduce((sum, q) => sum + (q.rating || 0), 0) / total).toFixed(1) : 
                    0.0;

                document.getElementById('totalQuestions').textContent = total;
                document.getElementById('approvedQuestions').textContent = approved;
                document.getElementById('categoriesCount').textContent = categories;
                document.getElementById('averageRating').textContent = avgRating;
            }

            applyFilters() {
                const typeFilter = document.getElementById('filterType').value;
                const difficultyFilter = document.getElementById('filterDifficulty').value;
                const categoryFilter = document.getElementById('filterCategory').value;
                const searchText = document.getElementById('searchText').value.toLowerCase();

                this.filteredQuestions = this.questions.filter(question => {
                    const matchType = !typeFilter || question.type === typeFilter;
                    const matchDifficulty = !difficultyFilter || question.difficulty === difficultyFilter;
                    const matchCategory = !categoryFilter || question.category === categoryFilter;
                    const matchSearch = !searchText || 
                        question.title.toLowerCase().includes(searchText) ||
                        question.question.toLowerCase().includes(searchText);

                    return matchType && matchDifficulty && matchCategory && matchSearch;
                });

                this.renderQuestions();
            }

            clearFilters() {
                document.getElementById('filterType').value = '';
                document.getElementById('filterDifficulty').value = '';
                document.getElementById('filterCategory').value = '';
                document.getElementById('searchText').value = '';
                this.filteredQuestions = [...this.questions];
                this.renderQuestions();
            }

            sortQuestions() {
                // ç°¡å˜ãªä¸¦ã³æ›¿ãˆãƒˆã‚°ãƒ«
                if (this.sortBy === 'created') {
                    this.sortBy = 'title';
                    this.sortOrder = 'asc';
                } else if (this.sortBy === 'title') {
                    this.sortBy = 'rating';
                    this.sortOrder = 'desc';
                } else {
                    this.sortBy = 'created';
                    this.sortOrder = 'desc';
                }

                this.filteredQuestions.sort((a, b) => {
                    let aVal = a[this.sortBy] || '';
                    let bVal = b[this.sortBy] || '';
                    
                    if (this.sortBy === 'created') {
                        aVal = new Date(aVal);
                        bVal = new Date(bVal);
                    }

                    if (this.sortOrder === 'asc') {
                        return aVal > bVal ? 1 : -1;
                    } else {
                        return aVal < bVal ? 1 : -1;
                    }
                });

                this.renderQuestions();
            }

            renderQuestions() {
                const container = document.getElementById('questionsList');
                
                if (this.filteredQuestions.length === 0) {
                    container.innerHTML = `
                        <div class="empty-state">
                            <div class="empty-state-icon">ğŸ”</div>
                            <h3>å•é¡ŒãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“</h3>
                            <p>ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼æ¡ä»¶ã‚’å¤‰æ›´ã™ã‚‹ã‹ã€æ–°ã—ã„å•é¡Œã‚’ä½œæˆã—ã¦ãã ã•ã„</p>
                        </div>
                    `;
                    return;
                }

                container.innerHTML = this.filteredQuestions.map(question => `
                    <div class="question-card" onclick="viewQuestion('${question.id}')">
                        <div class="question-header">
                            <div class="question-meta">
                                <span>ID: ${question.id}</span>
                                <span>ä½œæˆ: ${new Date(question.created).toLocaleDateString()}</span>
                                <span>è©•ä¾¡: â­${question.rating || 'N/A'}</span>
                            </div>
                        </div>
                        <div class="question-title">${question.title}</div>
                        <div class="question-content">${this.truncateText(question.question, 100)}</div>
                        <div class="question-tags">
                            <span class="tag tag-type">${question.type}</span>
                            <span class="tag tag-difficulty ${question.difficulty === 'ä¸­' ? 'medium' : question.difficulty === 'é›£' ? 'hard' : ''}">${question.difficulty}</span>
                            ${question.category ? `<span class="tag tag-category">${question.category}</span>` : ''}
                            <span class="tag tag-approval">æ‰¿èª${question.approvals || 0}</span>
                        </div>
                    </div>
                `).join('');
            }

            truncateText(text, maxLength) {
                if (text.length <= maxLength) return text;
                return text.substring(0, maxLength) + '...';
            }

            refreshQuestions() {
                this.loadQuestions();
                this.populateCategoryFilter();
                this.updateStats();
                this.applyFilters();
            }
        }

        // ã‚°ãƒ­ãƒ¼ãƒãƒ«é–¢æ•°
        function applyFilters() {
            window.mathSystem.applyFilters();
        }

        function clearFilters() {
            window.mathSystem.clearFilters();
        }

        function refreshQuestions() {
            window.mathSystem.refreshQuestions();
        }

        function sortQuestions() {
            window.mathSystem.sortQuestions();
        }

        function viewQuestion(questionId) {
            // å•é¡Œè©³ç´°è¡¨ç¤ºï¼ˆä»Šå¾Œå®Ÿè£…ï¼‰
            alert(`å•é¡Œ ${questionId} ã®è©³ç´°è¡¨ç¤ºæ©Ÿèƒ½ã¯ä»Šå¾Œå®Ÿè£…äºˆå®šã§ã™`);
        }

        function loadSampleData() {
            // çµ±ä¸€ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿
            const sampleData = [
                {
                    id: 'math_001',
                    type: 'A1',
                    title: 'äºŒæ¬¡æ–¹ç¨‹å¼ã®è§£',
                    question: 'xÂ² - 5x + 6 = 0 ã®è§£ã¯ï¼Ÿ',
                    choices: ['x = 1, 6', 'x = 2, 3', 'x = -2, -3', 'x = -1, -6'],
                    correct: 1,
                    difficulty: 'ä¸­',
                    category: 'ä»£æ•°',
                    explanation: 'å› æ•°åˆ†è§£ã™ã‚‹ã¨ (x-2)(x-3) = 0 ã‚ˆã‚Š x = 2, 3',
                    created: new Date().toISOString(),
                    approvals: 3,
                    rating: 4.2
                },
                {
                    id: 'math_002',
                    type: 'F1',
                    title: 'ä¸‰è§’é–¢æ•°ã®å€¤',
                    question: 'sin 60Â° ã®å€¤ã‚’æ±‚ã‚ãªã•ã„ã€‚',
                    answer: 'âˆš3/2',
                    difficulty: 'æ˜“',
                    category: 'ä¸‰è§’é–¢æ•°',
                    explanation: 'ç‰¹åˆ¥è§’ã®å€¤ã¨ã—ã¦è¦šãˆã‚‹åŸºæœ¬å€¤',
                    created: new Date().toISOString(),
                    approvals: 4,
                    rating: 4.0
                },
                {
                    id: 'math_003',
                    type: 'F2',
                    title: 'æ¥µé™ã®è¨ˆç®—',
                    question: 'lim(xâ†’0) sin x / x ã‚’æ±‚ã‚ã‚ˆã€‚',
                    answer: '1',
                    difficulty: 'é›£',
                    category: 'å¾®åˆ†',
                    explanation: 'ãƒ­ãƒ”ã‚¿ãƒ«ã®å®šç†ã‚’ä½¿ç”¨ã™ã‚‹ã‹ã€æ¨™æº–çš„ãªæ¥µé™ã¨ã—ã¦çŸ¥ã‚‰ã‚Œã¦ã„ã‚‹å€¤',
                    created: new Date().toISOString(),
                    approvals: 5,
                    rating: 3.8
                },
                {
                    id: 'math_004',
                    type: 'A1',
                    title: 'ç¢ºç‡ã®åŸºæœ¬',
                    question: 'ã‚³ã‚¤ãƒ³ã‚’3å›æŠ•ã’ã¦ã€ã™ã¹ã¦è¡¨ãŒå‡ºã‚‹ç¢ºç‡ã¯ï¼Ÿ',
                    choices: ['1/2', '1/4', '1/8', '1/16'],
                    correct: 2,
                    difficulty: 'æ˜“',
                    category: 'ç¢ºç‡',
                    explanation: '(1/2)Â³ = 1/8',
                    created: new Date().toISOString(),
                    approvals: 3,
                    rating: 4.5
                },
                {
                    id: 'math_005',
                    type: 'F1',
                    title: 'å¾®åˆ†ã®è¨ˆç®—',
                    question: 'f(x) = xÂ³ + 2xÂ² - x + 1 ã®å°é–¢æ•°ã‚’æ±‚ã‚ãªã•ã„ã€‚',
                    answer: 'f\'(x) = 3xÂ² + 4x - 1',
                    difficulty: 'ä¸­',
                    category: 'å¾®åˆ†',
                    explanation: 'å„é …ã‚’ã¹ãä¹—ã®å…¬å¼ã§å¾®åˆ†ã™ã‚‹',
                    created: new Date().toISOString(),
                    approvals: 4,
                    rating: 4.1
                }
            ];

            localStorage.setItem('mathQuestions', JSON.stringify(sampleData));
            window.mathSystem.refreshQuestions();
            alert('âœ… ã‚µãƒ³ãƒ—ãƒ«å•é¡Œã‚’5å•èª­ã¿è¾¼ã¿ã¾ã—ãŸï¼');
        }

        // ã‚·ã‚¹ãƒ†ãƒ åˆæœŸåŒ–
        document.addEventListener('DOMContentLoaded', () => {
            window.mathSystem = new UnifiedMathSystem();
        });
    </script>
</body>
</html>